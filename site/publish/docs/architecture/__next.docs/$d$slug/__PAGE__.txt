1:"$Sreact.fragment"
2:I[89992,["/_next/static/chunks/e7ce311063862ceb.js","/_next/static/chunks/b364a8343c8c3a75.js"],"default"]
7:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/7340adf74ff47ec0.js"],"OutletBoundary"]
8:"$Sreact.suspense"
3:T629,prose prose-lg max-w-none   prose-headings:text-gray-900 dark:prose-headings:text-white prose-headings:font-semibold   prose-h1:text-2xl prose-h1:border-b prose-h1:border-gray-200 dark:prose-h1:border-gray-700 prose-h1:pb-3 prose-h1:mb-6   prose-h2:text-xl prose-h2:mt-8 prose-h2:mb-4   prose-h3:text-lg prose-h3:mt-6 prose-h3:mb-3   prose-p:text-gray-700 dark:prose-p:text-gray-300 prose-p:leading-relaxed   prose-a:text-blue-600 dark:prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline   prose-strong:text-gray-900 dark:prose-strong:text-white prose-strong:font-semibold   prose-code:text-pink-600 dark:prose-code:text-pink-400 prose-code:bg-pink-50 dark:prose-code:bg-pink-900/30 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm   prose-pre:bg-gray-900 dark:prose-pre:bg-black prose-pre:text-gray-100 dark:prose-pre:text-gray-200 prose-pre:rounded-lg prose-pre:p-4   prose-blockquote:border-l-4 prose-blockquote:border-blue-200 dark:prose-blockquote:border-blue-700 prose-blockquote:bg-blue-50 dark:prose-blockquote:bg-blue-900/20 prose-blockquote:pl-4 prose-blockquote:py-2   prose-ul:my-4 prose-ol:my-4   prose-li:text-gray-700 dark:prose-li:text-gray-300   prose-table:border-collapse prose-table:border prose-table:border-gray-300 dark:prose-table:border-gray-600   prose-th:bg-gray-50 dark:prose-th:bg-gray-800 prose-th:border prose-th:border-gray-300 dark:prose-th:border-gray-600 prose-th:px-3 prose-th:py-2 prose-th:text-left   prose-td:border prose-td:border-gray-300 dark:prose-td:border-gray-600 prose-td:px-3 prose-td:py-24:T504d,<h2>Core-First Architecture (Phase 2 Complete)</h2>
<p>Formdown features a revolutionary <strong>Core-First architecture</strong> where the <code>@formdown/core</code> package provides comprehensive form management capabilities through the <strong>FormManager</strong> and <strong>4 Core modules</strong>. The UI and Editor packages are thin presentation layers that delegate 100% of their operations to these core APIs.</p>
<p><strong>Phase 2 Achievement</strong>: Complete legacy code elimination with 100% Core module integration across all packages.</p>
<h3>Package Structure</h3>
<p>Formdown is organized as a monorepo with three main packages:</p>
<ul>
<li><strong>@formdown/core</strong> ‚≠ê - Complete form lifecycle engine with 4 Core modules (depends only on <code>marked</code>)</li>
<li><strong>@formdown/ui</strong> üé® - Web component renderer with 100% Core delegation (1186 lines, 9.3% optimized)</li>
<li><strong>@formdown/editor</strong> ‚úèÔ∏è - Development editor with Core-powered real-time preview (505 lines + template consolidation)</li>
</ul>
<h3>Package Dependencies and Relationships</h3>
<ul>
<li><p><strong>formdown-core</strong>: Core-First architecture hub (depends only on <code>marked</code> for markdown processing)</p>
<ul>
<li><strong>FormManager</strong>: Central API with 12+ methods for complete form lifecycle management</li>
<li><strong>4 Core Modules</strong>: FieldProcessor, DOMBinder, ValidationManager, EventOrchestrator</li>
<li>Entry point: <code>packages/formdown-core/src/index.ts</code></li>
<li>Main parser: <code>packages/formdown-core/src/parser.ts</code> </li>
<li>HTML generator: <code>packages/formdown-core/src/generator.ts</code></li>
<li>Extensions system: <code>packages/formdown-core/src/extensions/</code></li>
</ul>
</li>
<li><p><strong>formdown-ui</strong>: Rendering layer with 100% Core integration (depends on formdown-core + Lit)</p>
<ul>
<li><strong>Phase 2.1 Complete</strong>: Full FormManager delegation, DOMBinder integration</li>
<li>Entry point: <code>packages/formdown-ui/src/index.ts</code></li>
<li>Main component: <code>packages/formdown-ui/src/formdown-ui.ts</code> (1186 lines)</li>
<li>Standalone build: <code>packages/formdown-ui/src/standalone.ts</code></li>
</ul>
</li>
<li><p><strong>formdown-editor</strong>: Development layer with 100% Core integration (depends on formdown-core + formdown-ui + Lit)</p>
<ul>
<li><strong>Phase 2.2 Complete</strong>: Full EventOrchestrator integration, legacy elimination</li>
<li>Entry point: <code>packages/formdown-editor/src/index.ts</code> </li>
<li>Editor component: <code>packages/formdown-editor/src/formdown-editor.ts</code> (505 lines)</li>
<li>Standalone build: <code>packages/formdown-editor/src/standalone.ts</code></li>
</ul>
</li>
</ul>
<h3>Build System Architecture</h3>
<p>Each package uses different build configurations:</p>
<ul>
<li><strong>Core</strong>: TypeScript compilation only (<code>tsc</code>)</li>
<li><strong>UI/Editor</strong>: Vite with multiple output formats:<ul>
<li>ES modules for bundlers (<code>dist/index.es.js</code>)</li>
<li>UMD for direct usage (<code>dist/index.umd.js</code>) </li>
<li>Standalone builds for CDN (<code>dist/standalone.js</code>)</li>
<li>TypeScript definitions (<code>dist/index.d.ts</code>)</li>
</ul>
</li>
</ul>
<h2>Core-First Design Pattern (Phase 2 Implementation)</h2>
<p>The Core-First architecture ensures complete business logic centralization through 4 specialized Core modules:</p>
<ol>
<li><strong>Business Logic Centralization</strong>: 100% of form operations handled by Core modules</li>
<li><strong>Framework Independence</strong>: Core functionality works without any UI framework</li>
<li><strong>Consistent Behavior</strong>: All UI layers share identical Core-powered behavior</li>
<li><strong>Modular Architecture</strong>: 4 specialized modules for different concerns</li>
<li><strong>Better Performance</strong>: Optimized Core with thin presentation layers</li>
</ol>
<h3>FormManager + 4 Core Modules Architecture</h3>
<p><strong>FormManager</strong> serves as the central coordinator for:</p>
<ul>
<li><strong>FieldProcessor</strong>: Field type processing, validation, and value extraction</li>
<li><strong>DOMBinder</strong>: DOM manipulation, event handling, and data synchronization</li>
<li><strong>ValidationManager</strong>: Async validation pipelines with caching and debouncing</li>
<li><strong>EventOrchestrator</strong>: Component-to-component event coordination and bridging</li>
</ul>
<h3>Enhanced Data Flow (Phase 2)</h3>
<pre class="language-markup"><code class="language-markup">User Input ‚Üí UI Component ‚Üí FormManager
    ‚Üì              ‚Üì              ‚Üì
EventOrchestrator ‚Üí FieldProcessor ‚Üí DOMBinder
    ‚Üì              ‚Üì              ‚Üì
Event Coordination ‚Üí Validation ‚Üí DOM Updates
    ‚Üì              ‚Üì              ‚Üì
Component Bridge ‚Üí ValidationManager ‚Üí Data Persistence</code></pre><h3>Core Module Responsibilities</h3>
<ul>
<li><strong>FieldProcessor</strong>: <code>extractFieldValue()</code>, <code>setFieldValue()</code>, <code>processCheckboxGroup()</code></li>
<li><strong>DOMBinder</strong>: <code>setupElementEventHandlers()</code>, <code>syncFormData()</code>, <code>clearAllBindings()</code></li>
<li><strong>ValidationManager</strong>: <code>validateAsync()</code>, <code>registerValidator()</code>, <code>dispose()</code></li>
<li><strong>EventOrchestrator</strong>: <code>createCoreUIBridge()</code>, <code>bridgeComponentEvents()</code>, <code>dispose()</code></li>
</ul>
<h2>Hidden Form Architecture</h2>
<p>Formdown uses a hidden form architecture to ensure maximum compatibility and progressive enhancement.</p>
<h3>How It Works</h3>
<ol>
<li><p><strong>Dual Rendering</strong>: Each field is rendered twice:</p>
<ul>
<li>Once in a hidden <code>&lt;form&gt;</code> element with standard HTML inputs</li>
<li>Once in the visible UI with enhanced styling and interactions</li>
</ul>
</li>
<li><p><strong>Value Synchronization</strong>: JavaScript keeps both representations in sync:</p>
<ul>
<li>User interactions with the visible UI update the hidden form fields</li>
<li>Form submissions use the hidden form&#39;s data</li>
</ul>
</li>
<li><p><strong>Progressive Enhancement</strong>: If JavaScript fails:</p>
<ul>
<li>The hidden form can be made visible via CSS</li>
<li>Forms remain fully functional with standard HTML behavior</li>
</ul>
</li>
</ol>
<h3>Benefits</h3>
<ul>
<li><strong>Accessibility</strong>: Screen readers work with standard form elements</li>
<li><strong>Browser Compatibility</strong>: Works with all form-related browser features</li>
<li><strong>Framework Integration</strong>: Easy to integrate with any form library</li>
<li><strong>SEO Friendly</strong>: Search engines can understand the form structure</li>
<li><strong>Graceful Degradation</strong>: Forms work even without JavaScript</li>
</ul>
<h3>Implementation Example</h3>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- Hidden form (actual form data) --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>formdown-form-1<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- Visible UI (enhanced presentation) --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>formdown-field<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Username<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>formdown-input<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre><h2>Extension System Architecture</h2>
<p>The extension system allows developers to extend Formdown&#39;s functionality through plugins and hooks.</p>
<h3>Extension Manager</h3>
<p>The ExtensionManager orchestrates all extensions:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ExtensionManager</span> <span class="token punctuation">{</span>
  <span class="token function">registerPlugin</span><span class="token punctuation">(</span>plugin<span class="token operator">:</span> Plugin<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span>
  <span class="token function">executeHooks</span><span class="token punctuation">(</span>hookType<span class="token operator">:</span> HookType<span class="token punctuation">,</span> context<span class="token operator">:</span> HookContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>HookContext<span class="token operator">></span>
  <span class="token function">getPluginInfo</span><span class="token punctuation">(</span>pluginName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> PluginInfo <span class="token operator">|</span> <span class="token keyword">null</span>
  <span class="token function">listPlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> PluginInfo<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><h3>Plugin Structure</h3>
<p>Plugins can provide:</p>
<ul>
<li><strong>Field Types</strong>: Custom field type definitions</li>
<li><strong>Validators</strong>: Custom validation logic</li>
<li><strong>Renderers</strong>: Custom HTML generation</li>
<li><strong>Hooks</strong>: Intercept and modify processing at various stages</li>
</ul>
<h3>Hook System</h3>
<p>Hooks allow fine-grained control over the parsing and generation pipeline:</p>
<ul>
<li><code>pre-parse</code>: Modify content before parsing</li>
<li><code>post-parse</code>: Modify parse results</li>
<li><code>field-parse</code>: Custom field parsing logic</li>
<li><code>field-validate</code>: Custom validation rules</li>
<li><code>pre-generate</code>: Modify data before HTML generation</li>
<li><code>post-generate</code>: Modify generated HTML</li>
<li><code>css-class</code>: Add custom CSS classes</li>
<li><code>attribute-inject</code>: Add custom HTML attributes</li>
</ul>
<h3>Event System</h3>
<p>The extension system is event-driven:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">on</span><span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> handler<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
  <span class="token function">off</span><span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> handler<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
  <span class="token function">emit</span><span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span></code></pre><h2>Testing Architecture</h2>
<h3>Test Structure</h3>
<ul>
<li><strong>Unit Tests</strong>: Each package has comprehensive unit tests</li>
<li><strong>Integration Tests</strong>: Test interactions between packages</li>
<li><strong>E2E Tests</strong>: Test complete user workflows</li>
</ul>
<h3>Test Configuration</h3>
<ul>
<li><strong>Jest</strong>: Unit testing framework</li>
<li><strong>@testing-library/dom</strong>: DOM testing utilities</li>
<li><strong>JSDOM</strong>: Browser environment simulation</li>
<li><strong>Mock Files</strong>: Located in <code>__tests__/mocks/</code></li>
</ul>
<h3>Test Patterns</h3>
<pre class="language-typescript"><code class="language-typescript"><span class="token comment">// Example test pattern</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'FormManager'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> manager<span class="token operator">:</span> FormManager
  
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    manager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'should parse formdown content'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'@name: [text required]'</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>forms<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveLength</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><h2>Performance Considerations</h2>
<h3>Optimization Strategies</h3>
<ol>
<li><strong>Lazy Loading</strong>: UI components load only when needed</li>
<li><strong>Tree Shaking</strong>: Unused code is eliminated during build</li>
<li><strong>Code Splitting</strong>: Separate bundles for different features</li>
<li><strong>Memoization</strong>: Cache expensive computations</li>
<li><strong>Virtual DOM</strong>: Efficient UI updates with Lit</li>
</ol>
<h3>Bundle Sizes</h3>
<ul>
<li>Core package: ~15KB minified + gzipped</li>
<li>UI package: ~25KB minified + gzipped (includes Lit)</li>
<li>Editor package: ~35KB minified + gzipped</li>
</ul>
<h2>Security Architecture</h2>
<h3>Input Sanitization</h3>
<p>All user input is sanitized to prevent XSS attacks:</p>
<ul>
<li>Field names are validated against allowed characters</li>
<li>HTML attributes are filtered through an allowlist</li>
<li>Generated HTML is escaped by default</li>
</ul>
<h3>Content Security Policy</h3>
<p>Formdown is designed to work with strict CSP:</p>
<ul>
<li>No inline scripts</li>
<li>No eval() usage</li>
<li>Event handlers use addEventListener</li>
</ul>
<h3>Data Privacy</h3>
<ul>
<li>No data is sent to external servers</li>
<li>All processing happens client-side</li>
<li>Form data is only accessible to the host application</li>
</ul>
0:{"buildId":"tbyODwIInToZwCMKdmxcK","rsc":["$","$1","c",{"children":[["$","$L2",null,{"currentSlug":"architecture","children":["$","div",null,{"children":[["$","h1",null,{"className":"text-3xl font-bold text-gray-900 dark:text-white mb-6","children":"Architecture"}],["$","article",null,{"className":"$3","dangerouslySetInnerHTML":{"__html":"$4"}}]]}]}],["$L5"],"$L6"]}],"loading":null,"isPartial":false}
5:["$","script","script-0",{"src":"/_next/static/chunks/b364a8343c8c3a75.js","async":true}]
6:["$","$L7",null,{"children":["$","$8",null,{"name":"Next.MetadataOutlet","children":"$@9"}]}]
9:null
