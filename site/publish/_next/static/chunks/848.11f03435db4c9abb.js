"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[848],{3483:(e,t,r)=>{r.d(t,{WF:()=>ep,AH:()=>c,qy:()=>Z,iz:()=>l});let n=globalThis,i=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),a=new WeakMap;class o{constructor(e,t,r){if(this._$cssResult$=!0,r!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(i&&void 0===e){let r=void 0!==t&&1===t.length;r&&(e=a.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&a.set(t,e))}return e}toString(){return this.cssText}}let l=e=>new o("string"==typeof e?e:e+"",void 0,s),c=(e,...t)=>new o(1===e.length?e[0]:t.reduce((t,r,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[n+1],e[0]),e,s),h=(e,t)=>{if(i)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(let r of t){let t=document.createElement("style"),i=n.litNonce;void 0!==i&&t.setAttribute("nonce",i),t.textContent=r.cssText,e.appendChild(t)}},d=i?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(let r of e.cssRules)t+=r.cssText;return l(t)})(e):e,{is:u,defineProperty:p,getOwnPropertyDescriptor:m,getOwnPropertyNames:f,getOwnPropertySymbols:g,getPrototypeOf:b}=Object,v=globalThis,y=v.trustedTypes,w=y?y.emptyScript:"",k=v.reactiveElementPolyfillSupport,x=(e,t)=>e,E={toAttribute(e,t){switch(t){case Boolean:e=e?w:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},_=(e,t)=>!u(e,t),A={attribute:!0,type:String,converter:E,reflect:!1,useDefault:!1,hasChanged:_};Symbol.metadata??=Symbol("metadata"),v.litPropertyMetadata??=new WeakMap;class S extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=A){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){let r=Symbol(),n=this.getPropertyDescriptor(e,r,t);void 0!==n&&p(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){let{get:n,set:i}=m(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:n,set(t){let s=n?.call(this);i?.call(this,t),this.requestUpdate(e,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??A}static _$Ei(){if(this.hasOwnProperty(x("elementProperties")))return;let e=b(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(x("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(x("properties"))){let e=this.properties;for(let t of[...f(e),...g(e)])this.createProperty(t,e[t])}let e=this[Symbol.metadata];if(null!==e){let t=litPropertyMetadata.get(e);if(void 0!==t)for(let[e,r]of t)this.elementProperties.set(e,r)}for(let[e,t]of(this._$Eh=new Map,this.elementProperties)){let r=this._$Eu(e,t);void 0!==r&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e))for(let r of new Set(e.flat(1/0).reverse()))t.unshift(d(r));else void 0!==e&&t.push(d(e));return t}static _$Eu(e,t){let r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){let e=new Map;for(let t of this.constructor.elementProperties.keys())this.hasOwnProperty(t)&&(e.set(t,this[t]),delete this[t]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return h(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){let r=this.constructor.elementProperties.get(e),n=this.constructor._$Eu(e,r);if(void 0!==n&&!0===r.reflect){let i=(void 0!==r.converter?.toAttribute?r.converter:E).toAttribute(t,r.type);this._$Em=e,null==i?this.removeAttribute(n):this.setAttribute(n,i),this._$Em=null}}_$AK(e,t){let r=this.constructor,n=r._$Eh.get(e);if(void 0!==n&&this._$Em!==n){let e=r.getPropertyOptions(n),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:E;this._$Em=n;let s=i.fromAttribute(t,e.type);this[n]=s??this._$Ej?.get(n)??s,this._$Em=null}}requestUpdate(e,t,r){if(void 0!==e){let n=this.constructor,i=this[e];if(!(((r??=n.getPropertyOptions(e)).hasChanged??_)(i,t)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(n._$Eu(e,r))))return;this.C(e,t,r)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:n,wrapped:i},s){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,s??t??this[e]),!0!==i||void 0!==s)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),!0===n&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}let e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(let[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}let e=this.constructor.elementProperties;if(e.size>0)for(let[t,r]of e){let{wrapped:e}=r,n=this[t];!0!==e||this._$AL.has(t)||void 0===n||this.C(t,void 0,r,n)}}let e=!1,t=this._$AL;try{(e=this.shouldUpdate(t))?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}}S.elementStyles=[],S.shadowRootOptions={mode:"open"},S[x("elementProperties")]=new Map,S[x("finalized")]=new Map,k?.({ReactiveElement:S}),(v.reactiveElementVersions??=[]).push("2.1.1");let $=globalThis,C=$.trustedTypes,T=C?C.createPolicy("lit-html",{createHTML:e=>e}):void 0,R="$lit$",F=`lit$${Math.random().toFixed(9).slice(2)}$`,P="?"+F,M=`<${P}>`,I=document,O=()=>I.createComment(""),L=e=>null===e||"object"!=typeof e&&"function"!=typeof e,D=Array.isArray,z=e=>D(e)||"function"==typeof e?.[Symbol.iterator],q="[ 	\n\f\r]",B=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,H=/-->/g,N=/>/g,U=RegExp(`>|${q}(?:([^\\s"'>=/]+)(${q}*=${q}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),V=/'/g,j=/"/g,W=/^(?:script|style|textarea|title)$/i,G=e=>(t,...r)=>({_$litType$:e,strings:t,values:r}),Z=G(1),Q=(G(2),G(3),Symbol.for("lit-noChange")),K=Symbol.for("lit-nothing"),J=new WeakMap,Y=I.createTreeWalker(I,129);function X(e,t){if(!D(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==T?T.createHTML(t):t}let ee=(e,t)=>{let r=e.length-1,n=[],i,s=2===t?"<svg>":3===t?"<math>":"",a=B;for(let t=0;t<r;t++){let r=e[t],o,l,c=-1,h=0;for(;h<r.length&&(a.lastIndex=h,null!==(l=a.exec(r)));)h=a.lastIndex,a===B?"!--"===l[1]?a=H:void 0!==l[1]?a=N:void 0!==l[2]?(W.test(l[2])&&(i=RegExp("</"+l[2],"g")),a=U):void 0!==l[3]&&(a=U):a===U?">"===l[0]?(a=i??B,c=-1):void 0===l[1]?c=-2:(c=a.lastIndex-l[2].length,o=l[1],a=void 0===l[3]?U:'"'===l[3]?j:V):a===j||a===V?a=U:a===H||a===N?a=B:(a=U,i=void 0);let d=a===U&&e[t+1].startsWith("/>")?" ":"";s+=a===B?r+M:c>=0?(n.push(o),r.slice(0,c)+R+r.slice(c)+F+d):r+F+(-2===c?t:d)}return[X(e,s+(e[r]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),n]};class et{constructor({strings:e,_$litType$:t},r){let n;this.parts=[];let i=0,s=0,a=e.length-1,o=this.parts,[l,c]=ee(e,t);if(this.el=et.createElement(l,r),Y.currentNode=this.el.content,2===t||3===t){let e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(n=Y.nextNode())&&o.length<a;){if(1===n.nodeType){if(n.hasAttributes())for(let e of n.getAttributeNames())if(e.endsWith(R)){let t=c[s++],r=n.getAttribute(e).split(F),a=/([.?@])?(.*)/.exec(t);o.push({type:1,index:i,name:a[2],strings:r,ctor:"."===a[1]?ea:"?"===a[1]?eo:"@"===a[1]?el:es}),n.removeAttribute(e)}else e.startsWith(F)&&(o.push({type:6,index:i}),n.removeAttribute(e));if(W.test(n.tagName)){let e=n.textContent.split(F),t=e.length-1;if(t>0){n.textContent=C?C.emptyScript:"";for(let r=0;r<t;r++)n.append(e[r],O()),Y.nextNode(),o.push({type:2,index:++i});n.append(e[t],O())}}}else if(8===n.nodeType)if(n.data===P)o.push({type:2,index:i});else{let e=-1;for(;-1!==(e=n.data.indexOf(F,e+1));)o.push({type:7,index:i}),e+=F.length-1}i++}}static createElement(e,t){let r=I.createElement("template");return r.innerHTML=e,r}}function er(e,t,r=e,n){if(t===Q)return t;let i=void 0!==n?r._$Co?.[n]:r._$Cl,s=L(t)?void 0:t._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),void 0===s?i=void 0:(i=new s(e))._$AT(e,r,n),void 0!==n?(r._$Co??=[])[n]=i:r._$Cl=i),void 0!==i&&(t=er(e,i._$AS(e,t.values),i,n)),t}class en{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:r}=this._$AD,n=(e?.creationScope??I).importNode(t,!0);Y.currentNode=n;let i=Y.nextNode(),s=0,a=0,o=r[0];for(;void 0!==o;){if(s===o.index){let t;2===o.type?t=new ei(i,i.nextSibling,this,e):1===o.type?t=new o.ctor(i,o.name,o.strings,this,e):6===o.type&&(t=new ec(i,this,e)),this._$AV.push(t),o=r[++a]}s!==o?.index&&(i=Y.nextNode(),s++)}return Y.currentNode=I,n}p(e){let t=0;for(let r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class ei{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,r,n){this.type=2,this._$AH=K,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=n,this._$Cv=n?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){L(e=er(this,e,t))?e===K||null==e||""===e?(this._$AH!==K&&this._$AR(),this._$AH=K):e!==this._$AH&&e!==Q&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):z(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==K&&L(this._$AH)?this._$AA.nextSibling.data=e:this.T(I.createTextNode(e)),this._$AH=e}$(e){let{values:t,_$litType$:r}=e,n="number"==typeof r?this._$AC(e):(void 0===r.el&&(r.el=et.createElement(X(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===n)this._$AH.p(t);else{let e=new en(n,this),r=e.u(this.options);e.p(t),this.T(r),this._$AH=e}}_$AC(e){let t=J.get(e.strings);return void 0===t&&J.set(e.strings,t=new et(e)),t}k(e){D(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,r,n=0;for(let i of e)n===t.length?t.push(r=new ei(this.O(O()),this.O(O()),this,this.options)):r=t[n],r._$AI(i),n++;n<t.length&&(this._$AR(r&&r._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){let t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class es{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,n,i){this.type=1,this._$AH=K,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=K}_$AI(e,t=this,r,n){let i=this.strings,s=!1;if(void 0===i)(s=!L(e=er(this,e,t,0))||e!==this._$AH&&e!==Q)&&(this._$AH=e);else{let n,a,o=e;for(e=i[0],n=0;n<i.length-1;n++)(a=er(this,o[r+n],t,n))===Q&&(a=this._$AH[n]),s||=!L(a)||a!==this._$AH[n],a===K?e=K:e!==K&&(e+=(a??"")+i[n+1]),this._$AH[n]=a}s&&!n&&this.j(e)}j(e){e===K?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class ea extends es{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===K?void 0:e}}class eo extends es{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==K)}}class el extends es{constructor(e,t,r,n,i){super(e,t,r,n,i),this.type=5}_$AI(e,t=this){if((e=er(this,e,t,0)??K)===Q)return;let r=this._$AH,n=e===K&&r!==K||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==K&&(r===K||n);n&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class ec{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){er(this,e)}}let eh=$.litHtmlPolyfillSupport;eh?.(et,ei),($.litHtmlVersions??=[]).push("3.3.1");let ed=(e,t,r)=>{let n=r?.renderBefore??t,i=n._$litPart$;if(void 0===i){let e=r?.renderBefore??null;n._$litPart$=i=new ei(t.insertBefore(O(),e),e,void 0,r??{})}return i._$AI(e),i},eu=globalThis;class ep extends S{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){let e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){let t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=ed(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Q}}ep._$litElement$=!0,ep.finalized=!0,eu.litElementHydrateSupport?.({LitElement:ep});let em=eu.litElementPolyfillSupport;em?.({LitElement:ep}),(eu.litElementVersions??=[]).push("4.2.1")},3848:(e,t,r)=>{r.r(t),r.d(t,{EditorExtensionSupport:()=>tw,FormdownEditor:()=>tS,createFormdownEditor:()=>tC,editorExtensionSupport:()=>tk,registerFormdownEditor:()=>tT});var n=r(5933),i=r(3483);function s(){let e=(0,n._)(['<div class="panel-header">Formdown Editor</div>']);return s=function(){return e},e}function a(){let e=(0,n._)(['\n                    <div class="editor-panel">\n                        ',"\n                        ",'\n                        <textarea\n                            class="editor-textarea"\n                            .value=',"\n                            @input=","\n                            @keydown=","\n                            placeholder=",'\n                            spellcheck="false"\n                        ></textarea>\n                        <div class="stats">\n                            <span>Lines: ',"</span>\n                            <span>Characters: ","</span>\n                        </div>\n                    </div>\n                "]);return a=function(){return e},e}function o(){let e=(0,n._)(['<div class="panel-header">Formdown UI</div>']);return o=function(){return e},e}function l(){let e=(0,n._)(['\n                    <div class="preview-panel">\n                        ','\n                        <div class="preview-content">\n                            ','\n                            <div id="formdown-ui-container"></div>\n                        </div>\n                    </div>\n                ']);return l=function(){return e},e}function c(){let e=(0,n._)(['\n            <div class="editor-container mode-','">\n                ',"\n                ","\n            </div>\n        "]);return c=function(){return e},e}function h(){let e=(0,n._)(['\n                    <button class="toolbar-button" @click=',">\n                        ","\n                    </button>\n                "]);return h=function(){return e},e}function d(){let e=(0,n._)(['\n            <div class="toolbar">\n                ',"\n            </div>\n        "]);return d=function(){return e},e}function u(){let e=(0,n._)(['\n                    <div class="error-item">',"</div>\n                "]);return u=function(){return e},e}function p(){let e=(0,n._)(['\n            <div class="error-list">\n                <strong>Errors:</strong>\n                ',"\n            </div>\n        "]);return p=function(){return e},e}function m(){let e=(0,n._)(["",""]);return m=function(){return e},e}var f=Object.defineProperty,g=(e,t,r)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b=(e,t,r)=>g(e,"symbol"!=typeof t?t+"":t,r);let v=globalThis,y=v.ShadowRoot&&(void 0===v.ShadyCSS||v.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,w=Symbol(),k=new WeakMap,x=class{get styleSheet(){let e=this.o,t=this.t;if(y&&void 0===e){let r=void 0!==t&&1===t.length;r&&(e=k.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&k.set(t,e))}return e}toString(){return this.cssText}constructor(e,t,r){if(this._$cssResult$=!0,r!==w)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}},E=e=>new x("string"==typeof e?e:e+"",void 0,w),_=(e,t)=>{if(y)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(let r of t){let t=document.createElement("style"),n=v.litNonce;void 0!==n&&t.setAttribute("nonce",n),t.textContent=r.cssText,e.appendChild(t)}},A=y?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(let r of e.cssRules)t+=r.cssText;return E(t)})(e):e,{is:S,defineProperty:$,getOwnPropertyDescriptor:C,getOwnPropertyNames:T,getOwnPropertySymbols:R,getPrototypeOf:F}=Object,P=globalThis,M=P.trustedTypes,I=M?M.emptyScript:"",O=P.reactiveElementPolyfillSupport,L=(e,t)=>e,D={toAttribute(e,t){switch(t){case Boolean:e=e?I:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},z=(e,t)=>!S(e,t),q={attribute:!0,type:String,converter:D,reflect:!1,useDefault:!1,hasChanged:z};null!=Symbol.metadata||(Symbol.metadata=Symbol("metadata")),null!=P.litPropertyMetadata||(P.litPropertyMetadata=new WeakMap);class B extends HTMLElement{static addInitializer(e){var t;this._$Ei(),(null!=(t=this.l)?t:this.l=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q;if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){let r=Symbol(),n=this.getPropertyDescriptor(e,r,t);void 0!==n&&$(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){var n;let{get:i,set:s}=null!=(n=C(this.prototype,e))?n:{get(){return this[t]},set(e){this[t]=e}};return{get:i,set(t){let n=null==i?void 0:i.call(this);null==s||s.call(this,t),this.requestUpdate(e,n,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){var t;return null!=(t=this.elementProperties.get(e))?t:q}static _$Ei(){if(this.hasOwnProperty(L("elementProperties")))return;let e=F(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(L("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(L("properties"))){let e=this.properties;for(let t of[...T(e),...R(e)])this.createProperty(t,e[t])}let e=this[Symbol.metadata];if(null!==e){let t=litPropertyMetadata.get(e);if(void 0!==t)for(let[e,r]of t)this.elementProperties.set(e,r)}for(let[e,t]of(this._$Eh=new Map,this.elementProperties)){let r=this._$Eu(e,t);void 0!==r&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e))for(let r of new Set(e.flat(1/0).reverse()))t.unshift(A(r));else void 0!==e&&t.push(A(e));return t}static _$Eu(e,t){let r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}_$Ev(){var e;this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),null==(e=this.constructor.l)||e.forEach(e=>e(this))}addController(e){var t,r;(null!=(r=this._$EO)?r:this._$EO=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&(null==(t=e.hostConnected)||t.call(e))}removeController(e){var t;null==(t=this._$EO)||t.delete(e)}_$E_(){let e=new Map;for(let t of this.constructor.elementProperties.keys())this.hasOwnProperty(t)&&(e.set(t,this[t]),delete this[t]);e.size>0&&(this._$Ep=e)}createRenderRoot(){var e;let t=null!=(e=this.shadowRoot)?e:this.attachShadow(this.constructor.shadowRootOptions);return _(t,this.constructor.elementStyles),t}connectedCallback(){var e,t;null!=this.renderRoot||(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null==(e=this._$EO)||e.forEach(e=>{var t;return null==(t=e.hostConnected)?void 0:t.call(e)})}enableUpdating(e){}disconnectedCallback(){var e;null==(e=this._$EO)||e.forEach(e=>{var t;return null==(t=e.hostDisconnected)?void 0:t.call(e)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){var r;let n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(void 0!==i&&!0===n.reflect){let s=((null==(r=n.converter)?void 0:r.toAttribute)!==void 0?n.converter:D).toAttribute(t,n.type);this._$Em=e,null==s?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(e,t){var r,n,i;let s=this.constructor,a=s._$Eh.get(e);if(void 0!==a&&this._$Em!==a){let e=s.getPropertyOptions(a),o="function"==typeof e.converter?{fromAttribute:e.converter}:(null==(r=e.converter)?void 0:r.fromAttribute)!==void 0?e.converter:D;this._$Em=a;let l=o.fromAttribute(t,e.type);this[a]=null!=(i=null!=l?l:null==(n=this._$Ej)?void 0:n.get(a))?i:l,this._$Em=null}}requestUpdate(e,t,r){var n,i;if(void 0!==e){let s=this.constructor,a=this[e];if(null!=r||(r=s.getPropertyOptions(e)),!((null!=(i=r.hasChanged)?i:z)(a,t)||r.useDefault&&r.reflect&&a===(null==(n=this._$Ej)?void 0:n.get(e))&&!this.hasAttribute(s._$Eu(e,r))))return;this.C(e,t,r)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,r,n){var i,s,a;let{useDefault:o,reflect:l,wrapped:c}=r;o&&!(null!=(i=this._$Ej)?i:this._$Ej=new Map).has(e)&&(this._$Ej.set(e,null!=(s=null!=n?n:t)?s:this[e]),!0!==c||void 0!==n)||(this._$AL.has(e)||(this.hasUpdated||o||(t=void 0),this._$AL.set(e,t)),!0===l&&this._$Em!==e&&(null!=(a=this._$Eq)?a:this._$Eq=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}let e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e,t;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(null!=this.renderRoot||(this.renderRoot=this.createRenderRoot()),this._$Ep){for(let[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}let e=this.constructor.elementProperties;if(e.size>0)for(let[t,r]of e){let{wrapped:e}=r,n=this[t];!0!==e||this._$AL.has(t)||void 0===n||this.C(t,void 0,r,n)}}let r=!1,n=this._$AL;try{(r=this.shouldUpdate(n))?(this.willUpdate(n),null==(e=this._$EO)||e.forEach(e=>{var t;return null==(t=e.hostUpdate)?void 0:t.call(e)}),this.update(n)):this._$EM()}catch(e){throw r=!1,this._$EM(),e}r&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null==(t=this._$EO)||t.forEach(e=>{var t;return null==(t=e.hostUpdated)?void 0:t.call(e)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(e=>this._$ET(e,this[e]))),this._$EM()}updated(e){}firstUpdated(e){}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}}B.elementStyles=[],B.shadowRootOptions={mode:"open"},B[L("elementProperties")]=new Map,B[L("finalized")]=new Map,null==O||O({ReactiveElement:B}),(null!=(e7=P.reactiveElementVersions)?e7:P.reactiveElementVersions=[]).push("2.1.1");let H={attribute:!0,type:String,converter:D,reflect:!1,hasChanged:z},N=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,{kind:n,metadata:i}=r,s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),"setter"===n&&((e=Object.create(e)).wrapped=!0),s.set(r.name,e),"accessor"===n){let{name:n}=r;return{set(r){let i=t.get.call(this);t.set.call(this,r),this.requestUpdate(n,i,e)},init(t){return void 0!==t&&this.C(n,void 0,e,t),t}}}if("setter"===n){let{name:n}=r;return function(r){let i=this[n];t.call(this,r),this.requestUpdate(n,i,e)}}throw Error("Unsupported decorator location: "+n)};function U(e){return(t,r)=>"object"==typeof r?N(e,t,r):((e,t,r)=>{let n=t.hasOwnProperty(r);return t.constructor.createProperty(r,e),n?Object.getOwnPropertyDescriptor(t,r):void 0})(e,t,r)}function V(e){return U({...e,state:!0,attribute:!1})}class j{register(e){let t=this.hooks.get(e.name)||[];t.push(e),t.sort((e,t)=>t.priority-e.priority),this.hooks.set(e.name,t),this.emit("hook-registered",{hook:e.name,priority:e.priority}),this.options.debug&&console.debug("[Formdown] Hook registered: ".concat(e.name," (priority: ").concat(e.priority,")"))}unregister(e,t){let r=this.hooks.get(e)||[],n=r.filter(e=>e.handler!==t);n.length!==r.length&&(this.hooks.set(e,n),this.emit("hook-unregistered",{hook:e}),this.options.debug&&console.debug("[Formdown] Hook unregistered: ".concat(e)))}async execute(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];let s=this.hooks.get(e)||[],a=[];for(let r of(this.emit("hooks-executing",{hook:e,count:s.length}),s)){let i=null;try{i=this.options.timeout?this.createTimeoutPromise(this.options.timeout):null;let s=Promise.resolve(r.handler(t,...n)),o=i?await Promise.race([s,i.promise]):await s;null==i||i.cleanup(),void 0!==o&&a.push(o),this.emit("hook-executed",{hook:e,success:!0})}catch(t){null==i||i.cleanup(),this.handleHookError(e,t)}}return this.emit("hooks-completed",{hook:e,results:a.length}),a}executeSync(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];let s=this.hooks.get(e)||[],a=[];for(let r of(this.emit("hooks-executing",{hook:e,count:s.length}),s))try{let i=r.handler(t,...n);void 0!==i&&a.push(i),this.emit("hook-executed",{hook:e,success:!0})}catch(t){this.handleHookError(e,t)}return this.emit("hooks-completed",{hook:e,results:a.length}),a}clear(e){e?(this.hooks.delete(e),this.emit("hooks-cleared",{hook:e})):(this.hooks.clear(),this.emit("hooks-cleared",{all:!0})),this.options.debug&&console.debug("[Formdown] Hooks cleared: ".concat(e||"all"))}getHooks(e){return[...this.hooks.get(e)||[]]}getHookNames(){return Array.from(this.hooks.keys())}getHookCount(){return Array.from(this.hooks.values()).reduce((e,t)=>e+t.length,0)}createTimeoutPromise(e){let t;return{promise:new Promise((r,n)=>{t=setTimeout(()=>{n(Error("Hook execution timeout after ".concat(e,"ms")))},e)}),cleanup:()=>{clearTimeout(t)}}}handleHookError(e,t){let r="Hook execution failed: ".concat(e," - ").concat(t.message||t);switch(this.emit("hook-error",{hook:e,error:r}),this.options.errorStrategy){case"ignore":break;case"warn":console.warn("[Formdown] ".concat(r));break;default:throw Error(r)}}emit(e,t){if(this.eventEmitter){let r={type:e,data:t,timestamp:Date.now()};this.eventEmitter.emit(e,r)}}constructor(e={},t){this.options=e,this.hooks=new Map,this.eventEmitter=t}}class W{async register(e){var t;if(this.plugins.has(e.metadata.name))throw Error("Plugin '".concat(e.metadata.name,"' is already registered"));if(await this.validateDependencies(e),this.plugins.set(e.metadata.name,e),e.hooks)for(let t of e.hooks)this.hookManager.register(t);if(e.fieldTypes)for(let r of e.fieldTypes)this.fieldTypes.set(r.type,r),null==(t=this.fieldTypeRegistry)||t.register(r);if(e.validators)for(let t of e.validators)this.validators.set(t.name,t);if(e.renderers)for(let t of e.renderers)this.renderers.set(t.template,t);if(e.themes)for(let t of e.themes)this.themes.set(t.name,t);if(this.emit("plugin-registered",{plugin:e.metadata.name,version:e.metadata.version}),this.options.debug&&console.debug("[Formdown] Plugin registered: ".concat(e.metadata.name," v").concat(e.metadata.version)),this.initialized&&e.initialize)try{await e.initialize(),this.emit("plugin-initialized",{plugin:e.metadata.name})}catch(t){this.handlePluginError(e.metadata.name,"initialization",t)}}async unregister(e){var t;let r=this.plugins.get(e);if(r){if(r.destroy)try{await r.destroy(),this.emit("plugin-destroyed",{plugin:e})}catch(t){this.handlePluginError(e,"cleanup",t)}if(r.hooks)for(let e of r.hooks)this.hookManager.unregister(e.name,e.handler);if(r.fieldTypes)for(let e of r.fieldTypes)this.fieldTypes.delete(e.type),null==(t=this.fieldTypeRegistry)||t.unregister(e.type);if(r.validators)for(let e of r.validators)this.validators.delete(e.name);if(r.renderers)for(let e of r.renderers)this.renderers.delete(e.template);if(r.themes)for(let e of r.themes)this.themes.delete(e.name);this.plugins.delete(e),this.emit("plugin-unregistered",{plugin:e}),this.options.debug&&console.debug("[Formdown] Plugin unregistered: ".concat(e))}}get(e){return this.plugins.get(e)}getAll(){return Array.from(this.plugins.values())}isRegistered(e){return this.plugins.has(e)}async initialize(){if(this.initialized)return;this.emit("plugins-initializing",{count:this.plugins.size});let e=[];for(let t of this.plugins.values())t.initialize&&e.push(Promise.resolve(t.initialize()).catch(e=>this.handlePluginError(t.metadata.name,"initialization",e)));await Promise.all(e),this.initialized=!0,this.emit("plugins-initialized",{count:this.plugins.size}),this.options.debug&&console.debug("[Formdown] ".concat(this.plugins.size," plugins initialized"))}async destroy(){if(!this.initialized)return;this.emit("plugins-destroying",{count:this.plugins.size});let e=[];for(let t of this.plugins.values())t.destroy&&e.push(Promise.resolve(t.destroy()).catch(e=>this.handlePluginError(t.metadata.name,"cleanup",e)));await Promise.all(e),this.plugins.clear(),this.fieldTypes.clear(),this.validators.clear(),this.renderers.clear(),this.themes.clear(),this.initialized=!1,this.emit("plugins-destroyed",{count:0}),this.options.debug&&console.debug("[Formdown] All plugins destroyed and cleared")}getFieldTypes(){return new Map(this.fieldTypes)}getFieldType(e){return this.fieldTypes.get(e)}hasFieldType(e){return this.fieldTypes.has(e)}getValidators(){return new Map(this.validators)}getRenderers(){return new Map(this.renderers)}getThemes(){return new Map(this.themes)}async validateDependencies(e){if(e.metadata.dependencies){for(let t of e.metadata.dependencies)if(!this.isRegistered(t))throw Error("Plugin '".concat(e.metadata.name,"' requires dependency '").concat(t,"' which is not registered"))}}handlePluginError(e,t,r){let n="Plugin ".concat(t," failed: ").concat(e," - ").concat(r.message||r);switch(this.emit("plugin-error",{plugin:e,operation:t,error:n}),this.options.errorStrategy){case"ignore":break;case"warn":console.warn("[Formdown] ".concat(n));break;default:throw Error(n)}}emit(e,t){this.eventEmitter&&this.eventEmitter.emit(e,t)}constructor(e,t={},r,n){this.hookManager=e,this.options=t,this.eventEmitter=r,this.fieldTypeRegistry=n,this.plugins=new Map,this.fieldTypes=new Map,this.validators=new Map,this.renderers=new Map,this.themes=new Map,this.initialized=!1}}class G{on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){let r=this.listeners.get(e);r&&(r.delete(t),0===r.size&&this.listeners.delete(e))}emit(e,t){let r=this.listeners.get(e);if(!r)return;let n={type:e,data:t,timestamp:Date.now()};for(let t of r)try{t(n)}catch(t){console.error("[Formdown] Event listener error in '".concat(e,"':"),t)}}once(e,t){let r=e=>{t(e),this.off(e.type,r)};this.on(e,r)}removeAllListeners(e){e?this.listeners.delete(e):this.listeners.clear()}listenerCount(e){var t;return(null==(t=this.listeners.get(e))?void 0:t.size)||0}eventNames(){return Array.from(this.listeners.keys())}constructor(){this.listeners=new Map}}class Z{register(e){if(this.fieldTypes.has(e.type))throw Error("Field type '".concat(e.type,"' is already registered"));this.fieldTypes.set(e.type,e),e.styles&&this.styleCache.set(e.type,e.styles),e.clientScript&&this.scriptCache.set(e.type,e.clientScript)}unregister(e){this.fieldTypes.delete(e),this.styleCache.delete(e),this.scriptCache.delete(e)}get(e){return this.fieldTypes.get(e)}has(e){return this.fieldTypes.has(e)}getAll(){return new Map(this.fieldTypes)}parseField(e,t){for(let r of this.fieldTypes.values())if(r.parser){let n=r.parser(e,t);if(n)return r.defaultAttributes&&(n.attributes={...r.defaultAttributes,...n.attributes}),n}return null}generateFieldHTML(e,t){let r=this.fieldTypes.get(e.type);return null!=r&&r.generator?r.generator(e,t):null}validateField(e,t){let r=this.fieldTypes.get(e.type);return null!=r&&r.validator?r.validator(e,t):[]}processFieldData(e,t,r){var n,i,s,a,o,l,c,h;let d=this.fieldTypes.get(e.type),u=null==d?void 0:d.dataProcessor;if(!u)return t;switch(r){case"input":return null!=(o=null==(n=u.processInput)?void 0:n.call(u,t,e))?o:t;case"output":return null!=(l=null==(i=u.processOutput)?void 0:i.call(u,t,e))?l:t;case"serialize":return null!=(c=null==(s=u.serialize)?void 0:s.call(u,t,e))?c:t;case"deserialize":return null!=(h=null==(a=u.deserialize)?void 0:a.call(u,t,e))?h:t;default:return t}}validateFieldData(e,t){let r=this.fieldTypes.get(e.type),n=null==r?void 0:r.dataProcessor;return null!=n&&n.validate?n.validate(t,e):{valid:!0}}generateFieldSchema(e){let t=this.fieldTypes.get(e.type);return null!=t&&t.schemaGenerator?t.schemaGenerator(e):null}getAllStyles(){return Array.from(this.styleCache.values()).join("\n")}getStylesForTypes(e){return e.map(e=>this.styleCache.get(e)).filter(Boolean).join("\n")}getAllScripts(){return Array.from(this.scriptCache.values()).join("\n")}getScriptsForTypes(e){return e.map(e=>this.scriptCache.get(e)).filter(Boolean).join("\n")}getStats(){return{registeredTypes:Array.from(this.fieldTypes.keys()),totalTypes:this.fieldTypes.size,typesWithStyles:Array.from(this.styleCache.keys()),typesWithScripts:Array.from(this.scriptCache.keys())}}clear(){this.fieldTypes.clear(),this.styleCache.clear(),this.scriptCache.clear()}constructor(){this.fieldTypes=new Map,this.styleCache=new Map,this.scriptCache=new Map}}let Q={metadata:{name:"formdown-core",version:"1.0.0",description:"Built-in field types and validators for Formdown",author:"Formdown Team"},fieldTypes:[{type:"text",parser:e=>{let t=e.match(/@(\w+):\s*\[text\](.*)/);if(!t)return null;let[,r,n]=t,i=K(n);return{name:r,type:"text",label:i.label||r,required:i.required||!1,placeholder:i.placeholder,pattern:i.pattern,attributes:i}},validator:(e,t)=>{let r=[];return e.required&&(!t||""===t.trim())&&r.push({type:"required",message:"".concat(e.label," is required")}),e.pattern&&t&&!new RegExp(e.pattern).test(t)&&r.push({type:"pattern",value:e.pattern,message:"".concat(e.label," does not match the required pattern")}),r},generator:e=>"<input ".concat(['type="text"','name="'.concat(e.name,'"'),'id="'.concat(e.name,'"'),e.placeholder?'placeholder="'.concat(e.placeholder,'"'):"",e.required?"required":"",e.pattern?'pattern="'.concat(e.pattern,'"'):""].filter(Boolean).join(" ")," />")},{type:"email",parser:e=>{let t=e.match(/@(\w+):\s*\[email\](.*)/);if(!t)return null;let[,r,n]=t,i=K(n);return{name:r,type:"email",label:i.label||r,required:i.required||!1,placeholder:i.placeholder,attributes:i}},validator:(e,t)=>{let r=[];return e.required&&(!t||""===t.trim())&&r.push({type:"required",message:"".concat(e.label," is required")}),t&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)&&r.push({type:"pattern",message:"".concat(e.label," must be a valid email address")}),r},generator:e=>"<input ".concat(['type="email"','name="'.concat(e.name,'"'),'id="'.concat(e.name,'"'),e.placeholder?'placeholder="'.concat(e.placeholder,'"'):"",e.required?"required":""].filter(Boolean).join(" ")," />")},{type:"select",parser:e=>{let t=e.match(/@(\w+):\s*\[select\](.*)/);if(!t)return null;let[,r,n]=t,i=K(n),s=function(e){let t=e.match(/options=\[([^\]]*)\]/);return t?t[1].split(",").map(e=>e.trim().replace(/"/g,"")).filter(Boolean):[]}(n);return{name:r,type:"select",label:i.label||r,required:i.required||!1,options:s,allowOther:i.allowOther||!1,attributes:i}},generator:e=>{let t=['name="'.concat(e.name,'"'),'id="'.concat(e.name,'"'),e.required?"required":""].filter(Boolean).join(" "),r=(e.options||[]).map(e=>'<option value="'.concat(e,'">').concat(e,"</option>")).join("\n");return"<select ".concat(t,">\n").concat(r,"\n</select>")}},{type:"range",parser:(e,t)=>{for(let t of[/@(\w+)(?:\(([^)]+)\))?\s*:\s*\[range\](.*)/,/@(\w+)(?:\(([^)]+)\))?\s*:\s*\[range\s+([^\]]+)\](.*)/]){let r=e.match(t);if(r){let[,e,t,n="",i=""]=r,s=function(e){let t={},r=e.match(/min=(\d+)/);r&&(t.min=parseInt(r[1]));let n=e.match(/max=(\d+)/);n&&(t.max=parseInt(n[1]));let i=e.match(/step=(\d+\.?\d*)/);i&&(t.step=parseFloat(i[1]));let s=e.match(/value=(\d+\.?\d*)/);s&&(t.value=parseFloat(s[1]));let a=e.match(/unit="([^"]*)"/);a&&(t.unit=a[1]),e.includes("hideValue")&&(t.showValue=!1),e.includes("required")&&(t.required=!0);let o=e.match(/label="([^"]*)"/);return o&&(t.label=o[1]),t}((n||"")+(i||""));return{name:e,type:"range",label:t||s.label||e.split(/[_-]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),required:s.required||!1,attributes:{min:s.min||0,max:s.max||100,step:s.step||1,value:s.value||Math.floor(((s.min||0)+(s.max||100))/2),showValue:!1!==s.showValue,unit:s.unit||"",...s}}}}return null},validator:(e,t)=>{var r,n,i;let s=[],a=Number(t);if(e.required&&(null==t||""===t)&&s.push({type:"required",message:"".concat(e.label," is required")}),null!=t&&""!==t)if(isNaN(a))s.push({type:"type",message:"".concat(e.label," must be a number")});else{let t=(null==(r=e.attributes)?void 0:r.min)||0,o=(null==(n=e.attributes)?void 0:n.max)||100;a<t&&s.push({type:"min",value:t,message:"".concat(e.label," must be at least ").concat(t)}),a>o&&s.push({type:"max",value:o,message:"".concat(e.label," must be at most ").concat(o)});let l=(null==(i=e.attributes)?void 0:i.step)||1;l>0&&(a-t)%l!=0&&s.push({type:"step",value:l,message:"".concat(e.label," must be a multiple of ").concat(l)})}return s},generator:(e,t)=>{var r;let{name:n,label:i,required:s,attributes:a={}}=e,{min:o=0,max:l=100,step:c=1,value:h=Math.floor((o+l)/2),showValue:d=!0,unit:u=""}=a,p="".concat(n,"-output"),m=null==(r=t.metadata)?void 0:r.formId,f=Object.entries({type:"range",id:n,name:n,min:o,max:l,step:c,value:h,...s&&{required:!0},...m&&{form:m},...Object.fromEntries(Object.entries(a).filter(e=>{let[t]=e;return!["min","max","step","value","showValue","unit","label"].includes(t)}))}).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" "),g=d?'<output id="'.concat(p,'" for="').concat(n,'" class="formdown-range-output">').concat(h).concat(u,"</output>"):"";return'\n<div class="formdown-field formdown-range-field">\n    <label for="'.concat(n,'">').concat(i).concat(s?" *":"",'</label>\n    <div class="formdown-range-container">\n        <input ').concat(f," oninput=\"document.getElementById('").concat(p,"').textContent = this.value + '").concat(u,"'\">\n        ").concat(g,"\n    </div>\n</div>")},dataProcessor:{processInput:(e,t)=>{let r=Number(e);return isNaN(r)?null:r},processOutput:(e,t)=>{var r;if(null==e)return"";let n=(null==(r=t.attributes)?void 0:r.unit)||"";return"".concat(e).concat(n)},validate:(e,t)=>{let r=Number(e);return null!=e&&""!==e&&isNaN(r)?{valid:!1,error:"Value must be a number"}:{valid:!0}},serialize:(e,t)=>String(e),deserialize:(e,t)=>{let r=Number(e);return isNaN(r)?null:r}},schemaGenerator:e=>{var t,r,n;let i={type:"number",minimum:(null==(t=e.attributes)?void 0:t.min)||0,maximum:(null==(r=e.attributes)?void 0:r.max)||100};return null!=(n=e.attributes)&&n.step&&(i.multipleOf=e.attributes.step),e.required&&(i.required=!0),e.label&&(i.title=e.label),i},styles:'\n        .formdown-range-field .formdown-range-container {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n        \n        .formdown-range-field input[type="range"] {\n            flex: 1;\n            min-width: 100px;\n        }\n        \n        .formdown-range-output {\n            min-width: 60px;\n            text-align: center;\n            font-weight: 600;\n            padding: 4px 8px;\n            background: #f5f5f5;\n            border-radius: 4px;\n            font-family: monospace;\n        }\n        \n        .formdown-range-field label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: 500;\n        }\n    ',clientScript:"\n        // Enhanced range field interactions\n        document.addEventListener('DOMContentLoaded', function() {\n            const rangeFields = document.querySelectorAll('.formdown-range-field input[type=\"range\"]');\n            \n            rangeFields.forEach(function(input) {\n                // Add keyboard navigation enhancement\n                input.addEventListener('keydown', function(e) {\n                    const step = parseFloat(this.step) || 1;\n                    const currentValue = parseFloat(this.value);\n                    \n                    if (e.key === 'ArrowLeft' || e.key === 'ArrowDown') {\n                        e.preventDefault();\n                        this.value = Math.max(parseFloat(this.min), currentValue - step);\n                        this.dispatchEvent(new Event('input', { bubbles: true }));\n                    } else if (e.key === 'ArrowRight' || e.key === 'ArrowUp') {\n                        e.preventDefault();\n                        this.value = Math.min(parseFloat(this.max), currentValue + step);\n                        this.dispatchEvent(new Event('input', { bubbles: true }));\n                    }\n                });\n                \n                // Add visual feedback on interaction\n                input.addEventListener('input', function() {\n                    this.classList.add('active');\n                    setTimeout(() => this.classList.remove('active'), 150);\n                });\n            });\n        });\n    ",defaultAttributes:{min:0,max:100,step:1,showValue:!0}}],validators:[{name:"required",validate:e=>null!=e&&""!==e,getMessage:(e,t)=>e.message||"".concat(t.label," is required")},{name:"pattern",validate:(e,t)=>!e||!t.value||new RegExp(t.value).test(e),getMessage:(e,t)=>e.message||"".concat(t.label," does not match the required pattern")},{name:"minlength",validate:(e,t)=>!e||e.length>=(t.value||0),getMessage:(e,t)=>e.message||"".concat(t.label," must be at least ").concat(e.value," characters long")}]};function K(e){let t={};e.includes("required")&&(t.required=!0);let r=e.match(/placeholder="([^"]*)"/);r&&(t.placeholder=r[1]);let n=e.match(/label="([^"]*)"/);n&&(t.label=n[1]);let i=e.match(/pattern="([^"]*)"/);return i&&(t.pattern=i[1]),e.includes("allowOther")&&(t.allowOther=!0),t}class J{async initialize(){if(!this.initialized){this.eventEmitter.emit("extension-system-initializing");try{await this.pluginManager.register(Q),await this.pluginManager.initialize(),this.initialized=!0,this.eventEmitter.emit("extension-system-initialized"),this.context.options.debug&&console.debug("[Formdown] Extension system initialized")}catch(e){throw this.eventEmitter.emit("extension-system-error",{phase:"initialization",error:e instanceof Error?e.message:String(e)}),e}}}async destroy(){if(this.initialized){this.eventEmitter.emit("extension-system-destroying");try{await this.pluginManager.destroy(),this.hookManager.clear(),this.eventEmitter.removeAllListeners(),this.initialized=!1,this.eventEmitter.emit("extension-system-destroyed"),this.context.options.debug&&console.debug("[Formdown] Extension system destroyed")}catch(e){throw this.eventEmitter.emit("extension-system-error",{phase:"destruction",error:e instanceof Error?e.message:String(e)}),e}}}async registerPlugin(e){return this.ensureInitialized(),this.pluginManager.register(e)}async unregisterPlugin(e){return this.ensureInitialized(),this.pluginManager.unregister(e)}registerHook(e){this.ensureInitialized(),this.hookManager.register(e)}async executeHooks(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this.ensureInitialized(),this.hookManager.execute(e,t,...n)}executeHooksSync(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this.ensureInitialized(),this.hookManager.executeSync(e,t,...n)}getContext(){return{...this.context}}getFieldTypeRegistry(){return this.fieldTypeRegistry}getEventEmitter(){return this.eventEmitter}getStats(){return{initialized:this.initialized,plugins:this.pluginManager.getAll().map(e=>({name:e.metadata.name,version:e.metadata.version})),hookCount:this.hookManager.getHookCount(),registeredHooks:this.hookManager.getHookNames(),fieldTypes:Array.from(this.pluginManager.getFieldTypes().keys()),validators:Array.from(this.pluginManager.getValidators().keys()),renderers:Array.from(this.pluginManager.getRenderers().keys()),themes:Array.from(this.pluginManager.getThemes().keys())}}enableDebug(){this.context.options.debug=!0,console.debug("[Formdown] Debug mode enabled"),console.debug("[Formdown] Extension system stats:",this.getStats())}disableDebug(){this.context.options.debug=!1}setupErrorHandling(){this.eventEmitter.on("hook-error",e=>{this.context.options.debug&&console.error("[Formdown] Hook error:",e.data)}),this.eventEmitter.on("plugin-error",e=>{this.context.options.debug&&console.error("[Formdown] Plugin error:",e.data)}),this.eventEmitter.on("extension-system-error",e=>{console.error("[Formdown] Extension system error:",e.data)})}ensureInitialized(){if(!this.initialized)throw Error("Extension system must be initialized before use")}constructor(e={}){this.initialized=!1;let t={async:!0,timeout:1e3,errorStrategy:"warn",debug:!1,...e};this.eventEmitter=new G,this.hookManager=new j(t,this.eventEmitter),this.fieldTypeRegistry=new Z,this.pluginManager=new W(this.hookManager,t,this.eventEmitter,this.fieldTypeRegistry),this.context={hooks:this.hookManager,plugins:this.pluginManager,fieldTypes:this.fieldTypeRegistry,options:t},this.setupErrorHandling()}}let Y=new J;async function X(e){return Y.registerPlugin(e)}function ee(e){return Y.registerHook(e)}class et{parseFormdown(e){this.formDeclarations=[],this.datalistDeclarations=[],this.currentFormId=null,this.formCounter=1,this.defaultFormCreated=!1;let{fields:t,cleanedMarkdown:r}=this.extractFields(e);return{markdown:this.options.preserveMarkdown?r:"",forms:t,formDeclarations:this.formDeclarations,datalistDeclarations:this.datalistDeclarations}}parse(e){let{fields:t}=this.extractFields(e);return{fields:t,errors:[]}}extractFields(e){let t=[],r=e.split("\n"),n=[];for(let e=0;e<r.length;e++){let i=r[e],s=this.parseFormDeclaration(i);if(s){this.formDeclarations.push(s),this.currentFormId=s.id,n.push("");continue}let a=this.parseDatalistDeclaration(i);if(a){this.datalistDeclarations.push(a),n.push("");continue}let o=this.parseBlockField(i);if(o){this.associateFieldWithForm(o),t.push(o),n.push("\x3c!--FORMDOWN_FIELD_".concat(t.length-1,"--\x3e"));continue}let{cleanedLine:l,inlineFields:c}=this.parseInlineFields(i);c.forEach(e=>this.associateFieldWithForm(e)),t.push(...c),n.push(l)}return{fields:t,cleanedMarkdown:n.join("\n")}}parseBlockField(e){let t=e.trim(),r=Y.getFieldTypeRegistry().parseField(t,{input:t});if(r)return r;let n=this.parseActionElement(t);if(n)return n;if(/^@\w+\*/.test(t)||/^@\w+\{.*?\}/.test(t)||/^@\w+\s*:\s*(dt|d|[#@%&t?TrscRFCMW$])\d*\[/.test(t)||/^@\w+\([^)]+\)\*/.test(t)||/^@\w+\([^)]+\)\{.*?\}/.test(t)||/^@\w+\([^)]+\)\s*:\s*(dt|d|[#@%&t?TrscRFCMW$])\d*\[/.test(t)){let e=this.parseShorthandBlockField(t);if(e)return e}let i=t.match(/^@(\w+)(?:\(([^)]+)\))?\s*:\s*\[([^\]]*)\].*$/);if(!i)return null;let[,s,a,o]=i;return this.createField(s,a,o)}parseShorthandBlockField(e){let t=e.match(/^@(\w+)(\*)?(?:\{(.*?)\})?(?:\(([^)]+)\))?\s*:\s*(dt|d|[#@%&t?TrscRFCMW$])?(\d*)\[([^\]]*)\].*$/);if(!t&&(t=e.match(/^@(\w+)(?:\(([^)]+)\))?(\*)?(?:\{(.*?)\})?\s*:\s*(dt|d|[#@%&t?TrscRFCMW$])?(\d*)\[([^\]]*)\].*$/))){let[,e,r,n,i,s,a,o]=t;t=[t[0],e,n,i,r,s,a,o]}if(!t)return null;let[,r,n,i,s,a,o,l]=t;return n||void 0!==i||s||a||o?this.convertShorthandToField(r,n,i,s,a||"",o,l):null}parseInlineFields(e){let t=[],r=this.options.inlineFieldDelimiter,n=RegExp("(dt|d|[#@%&t?TrscRFCMW$]?)".concat(r,"@(\\w+)(\\*)?(?:\\{(.*?)\\})?(?:\\(([^)]+)\\))?(?:\\[([^\\]]*)\\])?"),"g"),i=e.replace(n,(e,r,n,i,s,a,o)=>{if(!r&&!i&&!s)return e;let l=this.convertShorthandToField(n,i,s,a,r,"",o||"");if(l){l.inline=!0,t.push(l);let e=l.required?' data-required="true"':"";return'<span contenteditable="true" data-field-name="'.concat(n,'" data-field-type="').concat(l.type,'" data-placeholder="').concat(l.label||n,'" class="formdown-inline-field" role="textbox"').concat(e,">").concat(l.label||n,"</span>")}return e}),s=RegExp("".concat(r,"@(\\w+)(?:\\(([^)]+)\\))?(?:\\[([^\\]]*)\\])?"),"g");return{cleanedLine:i=i.replace(s,(e,r,n,i)=>{if(t.some(e=>e.name===r))return e;let s=this.createField(r,n,void 0!==i?i:"text");if(s){s.inline=!0,t.push(s);let e=s.required?' data-required="true"':"";return'<span contenteditable="true" data-field-name="'.concat(r,'" data-field-type="').concat(s.type,'" data-placeholder="').concat(s.label||r,'" class="formdown-inline-field" role="textbox"').concat(e,">").concat(s.label||r,"</span>")}return e}),inlineFields:t}}convertShorthandToField(e,t,r,n,i,s,a){let o={"@":"email","#":"number","%":"tel","&":"url",d:"date",t:"time",dt:"datetime-local","?":"password",T:"textarea",r:"radio",s:"select",c:"checkbox",R:"range",F:"file",C:"color",M:"month",W:"week",$:"number"}[i]||"text",l=a?this.parseAttributes(a):{};if("*"===t&&(l.required=!0),"textarea"===o&&s&&(l.rows=parseInt(s,10)),"$"===i&&(l.inputmode="decimal",l.step="0.01",l.placeholder||(l.placeholder="0.00")),r){let e=this.interpretContent(r,i);l={...l,...e}}let c=this.buildTypeAndAttributesString(o,l);return this.createField(e,n,c)}interpretContent(e,t){if(["r","s","c"].includes(t)){let t=e.split(",").map(e=>e.trim()).filter(e=>e.length>0),r=!1,n="Other",i={options:t.filter(e=>"*"===e?(r=!0,!1):!(e.startsWith("*(")&&e.endsWith(")"))||(r||(r=!0,n=e.slice(2,-1)),!1)).join(",")||""};return r&&(i["allow-other"]=!0,"Other"!==n&&(i["other-label"]=n)),i}if(["d","t","dt"].includes(t))return{format:e};let r=e.includes(","),n=e.match(/^\^.*\$$/)||e.includes("[")&&e.includes("]")&&!r||e.includes("\\"),i=e.includes("#")||!r&&e.includes("*");if(n||i){let t=e;return(e.includes("#")||e.includes("*")&&!e.match(/^\^.*\$$/))&&(t="^"+e.replace(/[().\/]/g,"\\$&").replace(/-/g,"\\-").replace(/#{1,}/g,e=>"\\d{".concat(e.length,"}")).replace(/\*/g,".*").replace(/\?/g,".")+"$"),{pattern:t}}if(e&&!["r","s","c","d","t","dt"].includes(t)){let t=e.split(",").map(e=>e.trim()).filter(e=>e.length>0);if(t.length>0){let r=this.generateDatalistId(e);return this.datalistDeclarations.find(e=>e.id===r)||this.datalistDeclarations.push({id:r,options:t}),{list:r}}}return{pattern:e}}parseAttributes(e){let t={};for(let r of Array.from(e.matchAll(/([\w-]+)(?:=(?:"([^"]*)"|'([^']*)'|([^\s]+)))?/g))){let[,e,n,i,s]=r;if("required"===e)t.required=!0;else if(void 0!==n||void 0!==i||void 0!==s){let r=void 0!==n?n:void 0!==i?i:s;t[e]=this.parseAttributeValue(r)}else t[e]=!0}return t}buildTypeAndAttributesString(e,t){let r=[e];for(let[e,n]of Object.entries(t))!0===n?r.push(e):"string"==typeof n?r.push("".concat(e,'="').concat(n,'"')):r.push("".concat(e,"=").concat(n));return r.join(" ")}createField(e,t,r){if(/^\d/.test(e)||!e.trim())return null;if(!r.trim())return{name:e,type:"text",label:t||this.formatLabel(e),attributes:{}};let n=Array.from(r.matchAll(/([\w-]+)(?:=(?:"([^"]*)"|'([^']*)'|([^\s]+)))?/g));if(0===n.length)return null;let i="text",s=-1;for(let e=0;e<n.length;e++){let[,t,r,a,o]=n[e];if(!r&&!a&&!o&&["text","email","password","number","tel","url","search","date","time","datetime-local","month","week","color","file","range","radio","checkbox","select","textarea","submit","reset","button","hidden"].includes(t)){i=t,s=e;break}}let a={name:e,type:i,label:t||this.formatLabel(e),attributes:{}};for(let e=0;e<n.length;e++){if(e===s)continue;let[,t,r,o,l]=n[e];if("required"===t)a.required=!0;else if("label"===t&&(void 0!==r||void 0!==o||void 0!==l))a.label=r||o||l;else if("placeholder"===t&&(void 0!==r||void 0!==o||void 0!==l))a.placeholder=r||o||l;else if("options"===t&&(void 0!==r||void 0!==o||void 0!==l)){let e=r||o||l;if(["radio","checkbox","select"].includes(i))if(e){let t=e.split(",").map(e=>e.trim()).filter(e=>e.length>0),r=!1,n="Other";a.options=t.filter(e=>"*"===e?(r=!0,!1):!(e.startsWith("*(")&&e.endsWith(")"))||(r||(r=!0,n=e.slice(2,-1)),!1)),r&&(a.allowOther=!0,"Other"!==n&&(a.otherLabel=n))}else a.options=[]}else if("allow-other"===t)a.allowOther=!0;else if("other-label"===t&&(void 0!==r||void 0!==o||void 0!==l))a.otherLabel=r||o||l;else if("format"===t&&(void 0!==r||void 0!==o||void 0!==l))a.format=r||o||l;else if("pattern"===t&&(void 0!==r||void 0!==o||void 0!==l))a.pattern=r||o||l;else if("content"===t&&(void 0!==r||void 0!==o||void 0!==l))a.content=r||o||l;else if("value"===t)void 0!==r||void 0!==o?a.value=void 0!==r?r:o:void 0!==l?a.value=this.parseAttributeValue(l):a.value="";else if("datalist"===t&&(void 0!==r||void 0!==o||void 0!==l))a.attributes.list=r||o||l;else if(void 0!==r||void 0!==o||void 0!==l){let e=r||o||l;a.attributes[t]=this.parseAttributeValue(e)}else a.attributes[t]=!0}return a}formatLabel(e){return e.includes("_")?e.split("_").map(e=>this.capitalizeWord(e)).join(" "):/[a-z][A-Z]/.test(e)?e.replace(/([a-z])([A-Z])/g,"$1 $2").split(" ").map(e=>this.capitalizeWord(e)).join(" "):this.capitalizeWord(e)}capitalizeWord(e){return e&&e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}parseActionElement(e){let t=e.match(/^@\[(\w+)\s+"([^"]+)"([^\]]*)\]$/);if(!t)return null;let[,r,n,i]=t;if(!["submit","reset","button","image"].includes(r))return null;let s="".concat(r,"_").concat(Math.random().toString(36).substr(2,9)),a={};i.trim()&&Object.assign(a,this.parseAttributes(i.trim()));let o={name:s,type:"image"===r?"image":"button",label:n,attributes:{type:r,...a}};return"image"!==r||a.src||console.warn("Image action element missing src attribute: ".concat(e)),o}parseAttributeValue(e){return""===e?"":/^-?\d+$/.test(e)?parseInt(e,10):/^-?\d*\.\d+$/.test(e)?parseFloat(e):"true"===e||"false"!==e&&e}parseFormDeclaration(e){let t=e.trim().match(/^@form\[([^\]]*)\]\s*$/);if(!t)return null;let r=t[1],n=this.parseAttributes(r),i=n.id||this.generateFormId();return n.id&&delete n.id,{id:i,attributes:n}}generateFormId(){return"formdown-form-".concat(this.formCounter++)}generateDatalistId(e){let t=e.toLowerCase().replace(/\s+/g,"").replace(/,/g,"-").split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0);return"datalist-".concat(Math.abs(t))}parseDatalistDeclaration(e){let t=e.trim().match(/^@datalist\[([^\]]*)\]\s*$/);if(!t)return null;let r=t[1],n=this.parseAttributes(r);if(!n.id)return console.warn("Datalist declaration missing required id attribute:",e),null;if(void 0===n.options)return console.warn("Datalist declaration missing required options attribute:",e),null;let i="string"==typeof n.options?n.options.split(",").map(e=>e.trim()).filter(e=>e.length>0):[];return 0===i.length?(console.warn("Datalist declaration has empty options:",e),null):{id:n.id,options:i}}getDefaultFormId(){return this.defaultFormCreated||(this.defaultFormCreated=!0,this.formDeclarations.push({id:"formdown-form-default",attributes:{action:".",method:"GET"}})),"formdown-form-default"}associateFieldWithForm(e){var t;if(null!=(t=e.attributes)&&t.form){this.formDeclarations.some(t=>t.id===e.attributes.form)||(console.warn('FormDown: Referenced form "'.concat(e.attributes.form,'" does not exist. Using current or default form.')),e.attributes.form=this.currentFormId||this.getDefaultFormId());return}this.currentFormId?(e.attributes||(e.attributes={}),e.attributes.form=this.currentFormId):(e.attributes||(e.attributes={}),e.attributes.form=this.getDefaultFormId())}constructor(e={}){this.formDeclarations=[],this.datalistDeclarations=[],this.currentFormId=null,this.formCounter=1,this.defaultFormCreated=!1,this.options={preserveMarkdown:!0,fieldPrefix:"@",inlineFieldDelimiter:"___",autoGenerateFormIds:!0,...e}}}function er(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var en=er(),ei={exec:()=>null};function es(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="string"==typeof e?e:e.source,n={replace:(e,t)=>{let i="string"==typeof t?t:t.source;return i=i.replace(ea.caret,"$1"),r=r.replace(e,i),n},getRegex:()=>new RegExp(r,t)};return n}var ea={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:RegExp("[\\p{L}\\p{N}]","u"),escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp("^( {0,3}".concat(e,")((?:[	 ][^\\n]*)?(?:\\n|$))")),nextBulletRegex:e=>new RegExp("^ {0,".concat(Math.min(3,e-1),"}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))")),hrRegex:e=>new RegExp("^ {0,".concat(Math.min(3,e-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),fencesBeginRegex:e=>new RegExp("^ {0,".concat(Math.min(3,e-1),"}(?:```|~~~)")),headingBeginRegex:e=>new RegExp("^ {0,".concat(Math.min(3,e-1),"}#")),htmlBeginRegex:e=>RegExp("^ {0,".concat(Math.min(3,e-1),"}<(?:[a-z].*>|!--)"),"i")},eo=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,el=/(?:[*+-]|\d{1,9}[.)])/,ec=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,eh=es(ec).replace(/bull/g,el).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),ed=es(ec).replace(/bull/g,el).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),eu=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ep=/(?!\s*\])(?:\\.|[^\[\]\\])+/,em=es(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ep).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ef=es(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,el).getRegex(),eg="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",eb=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ev=es("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",eb).replace("tag",eg).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ey=es(eu).replace("hr",eo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",eg).getRegex(),ew={blockquote:es(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ey).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:em,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:eo,html:ev,lheading:eh,list:ef,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:ey,table:ei,text:/^[^\n]+/},ek=es("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",eo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",eg).getRegex(),ex={...ew,lheading:ed,table:ek,paragraph:es(eu).replace("hr",eo).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ek).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",eg).getRegex()},eE={...ew,html:es("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",eb).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ei,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:es(eu).replace("hr",eo).replace("heading"," *#{1,6} *[^\n]").replace("lheading",eh).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},e_=/^( {2,}|\\)\n(?!\s*$)/,eA=RegExp("[\\p{P}\\p{S}]","u"),eS=RegExp("[\\s\\p{P}\\p{S}]","u"),e$=RegExp("[^\\s\\p{P}\\p{S}]","u"),eC=es(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,eS).getRegex(),eT=RegExp("(?!~)[\\p{P}\\p{S}]","u"),eR=RegExp("(?!~)[\\s\\p{P}\\p{S}]","u"),eF=RegExp("(?:[^\\s\\p{P}\\p{S}]|~)","u"),eP=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,eM=es(eP,"u").replace(/punct/g,eA).getRegex(),eI=es(eP,"u").replace(/punct/g,eT).getRegex(),eO="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",eL=es(eO,"gu").replace(/notPunctSpace/g,e$).replace(/punctSpace/g,eS).replace(/punct/g,eA).getRegex(),eD=es(eO,"gu").replace(/notPunctSpace/g,eF).replace(/punctSpace/g,eR).replace(/punct/g,eT).getRegex(),ez=es("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,e$).replace(/punctSpace/g,eS).replace(/punct/g,eA).getRegex(),eq=es(/\\(punct)/,"gu").replace(/punct/g,eA).getRegex(),eB=es(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),eH=es(eb).replace("(?:--\x3e|$)","--\x3e").getRegex(),eN=es("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",eH).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),eU=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,eV=es(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",eU).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ej=es(/^!?\[(label)\]\[(ref)\]/).replace("label",eU).replace("ref",ep).getRegex(),eW=es(/^!?\[(ref)\](?:\[\])?/).replace("ref",ep).getRegex(),eG=es("reflink|nolink(?!\\()","g").replace("reflink",ej).replace("nolink",eW).getRegex(),eZ={_backpedal:ei,anyPunctuation:eq,autolink:eB,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:e_,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:ei,emStrongLDelim:eM,emStrongRDelimAst:eL,emStrongRDelimUnd:ez,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:eV,nolink:eW,punctuation:eC,reflink:ej,reflinkSearch:eG,tag:eN,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:ei},eQ={...eZ,link:es(/^!?\[(label)\]\((.*?)\)/).replace("label",eU).getRegex(),reflink:es(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",eU).getRegex()},eK={...eZ,emStrongRDelimAst:eD,emStrongLDelim:eI,url:es(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},eJ={...eK,br:es(e_).replace("{2,}","*").getRegex(),text:es(eK.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},eY={normal:ew,gfm:ex,pedantic:eE},eX={normal:eZ,gfm:eK,breaks:eJ,pedantic:eQ},e0={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},e1=e=>e0[e];function e2(e,t){if(t){if(ea.escapeTest.test(e))return e.replace(ea.escapeReplace,e1)}else if(ea.escapeTestNoEncode.test(e))return e.replace(ea.escapeReplaceNoEncode,e1);return e}function e3(e){try{e=encodeURI(e).replace(ea.percentDecode,"%")}catch(e){return null}return e}function e5(e,t){var r;let n=e.replace(ea.findPipe,(e,t,r)=>{let n=!1,i=t;for(;--i>=0&&"\\"===r[i];)n=!n;return n?"|":" |"}).split(ea.splitPipe),i=0;if(n[0].trim()||n.shift(),n.length>0&&!(null!=(r=n.at(-1))&&r.trim())&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(ea.slashPipe,"|");return n}function e6(e,t,r){let n=e.length;if(0===n)return"";let i=0;for(;i<n&&e.charAt(n-i-1)===t;)i++;return e.slice(0,n-i)}function e9(e,t,r,n,i){let s=t.href,a=t.title||null,o=e[1].replace(i.other.outputLinkReplace,"$1");n.state.inLink=!0;let l={type:"!"===e[0].charAt(0)?"image":"link",raw:r,href:s,title:a,text:o,tokens:n.inlineTokens(o)};return n.state.inLink=!1,l}var e4,e8,e7,te,tt=class{space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:e6(e,"\n")}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],r=function(e,t,r){let n=e.match(r.other.indentCodeCompensation);if(null===n)return t;let i=n[1];return t.split("\n").map(e=>{let t=e.match(r.other.beginningSpace);if(null===t)return e;let[n]=t;return n.length>=i.length?e.slice(i.length):e}).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){let t=e6(e,"#");(this.options.pedantic||!t||this.rules.other.endingSpaceChar.test(t))&&(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:e6(t[0],"\n")}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=e6(t[0],"\n").split("\n"),r="",n="",i=[];for(;e.length>0;){let t,s=!1,a=[];for(t=0;t<e.length;t++)if(this.rules.other.blockquoteStart.test(e[t]))a.push(e[t]),s=!0;else if(s)break;else a.push(e[t]);e=e.slice(t);let o=a.join("\n"),l=o.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");r=r?"".concat(r,"\n").concat(o):o,n=n?"".concat(n,"\n").concat(l):l;let c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,i,!0),this.lexer.state.top=c,0===e.length)break;let h=i.at(-1);if((null==h?void 0:h.type)==="code")break;if((null==h?void 0:h.type)==="blockquote"){let t=h.raw+"\n"+e.join("\n"),s=this.blockquote(t);i[i.length-1]=s,r=r.substring(0,r.length-h.raw.length)+s.raw,n=n.substring(0,n.length-h.text.length)+s.text;break}if((null==h?void 0:h.type)==="list"){let t=h.raw+"\n"+e.join("\n"),s=this.list(t);i[i.length-1]=s,r=r.substring(0,r.length-h.raw.length)+s.raw,n=n.substring(0,n.length-h.raw.length)+s.raw,e=t.substring(i.at(-1).raw.length).split("\n");continue}}return{type:"blockquote",raw:r,tokens:i,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim(),n=r.length>1,i={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?"\\d{1,9}\\".concat(r.slice(-1)):"\\".concat(r),this.options.pedantic&&(r=n?r:"[*+-]");let s=this.rules.other.listItemRegex(r),a=!1;for(;e;){let r=!1,n="",o="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;n=t[0],e=e.substring(n.length);let l=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,e=>" ".repeat(3*e.length)),c=e.split("\n",1)[0],h=!l.trim(),d=0;if(this.options.pedantic?(d=2,o=l.trimStart()):h?d=t[1].length+1:(d=(d=t[2].search(this.rules.other.nonSpaceChar))>4?1:d,o=l.slice(d),d+=t[1].length),h&&this.rules.other.blankLine.test(c)&&(n+=c+"\n",e=e.substring(c.length+1),r=!0),!r){let t=this.rules.other.nextBulletRegex(d),r=this.rules.other.hrRegex(d),i=this.rules.other.fencesBeginRegex(d),s=this.rules.other.headingBeginRegex(d),a=this.rules.other.htmlBeginRegex(d);for(;e;){let u,p=e.split("\n",1)[0];if(c=p,u=this.options.pedantic?c=c.replace(this.rules.other.listReplaceNesting,"  "):c.replace(this.rules.other.tabCharGlobal,"    "),i.test(c)||s.test(c)||a.test(c)||t.test(c)||r.test(c))break;if(u.search(this.rules.other.nonSpaceChar)>=d||!c.trim())o+="\n"+u.slice(d);else{if(h||l.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||i.test(l)||s.test(l)||r.test(l))break;o+="\n"+c}h||c.trim()||(h=!0),n+=p+"\n",e=e.substring(p.length+1),l=u.slice(d)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(n)&&(a=!0));let u=null,p;this.options.gfm&&(u=this.rules.other.listIsTask.exec(o))&&(p="[ ] "!==u[0],o=o.replace(this.rules.other.listReplaceTask,"")),i.items.push({type:"list_item",raw:n,task:!!u,checked:p,loose:!1,text:o,tokens:[]}),i.raw+=n}let o=i.items.at(-1);if(!o)return;o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){let t=i.items[e].tokens.filter(e=>"space"===e.type);i.loose=t.length>0&&t.some(e=>this.rules.other.anyLine.test(e.raw))}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:r,title:n}}}table(e){var t;let r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;let n=e5(r[1]),i=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=null!=(t=r[3])&&t.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],a={type:"table",raw:r[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let e of i)this.rules.other.tableAlignRight.test(e)?a.align.push("right"):this.rules.other.tableAlignCenter.test(e)?a.align.push("center"):this.rules.other.tableAlignLeft.test(e)?a.align.push("left"):a.align.push(null);for(let e=0;e<n.length;e++)a.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:a.align[e]});for(let e of s)a.rows.push(e5(e,a.header.length).map((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:a.align[t]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;let t=e6(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{let e=function(e,t){if(-1===e.indexOf(")"))return -1;let r=0;for(let n=0;n<e.length;n++)if("\\"===e[n])n++;else if("("===e[n])r++;else if(e[n]===t[1]&&--r<0)return n;return r>0?-2:-1}(t[2],"()");if(-2===e)return;if(e>-1){let r=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,r).trim(),t[3]=""}}let r=t[2],n="";if(this.options.pedantic){let e=this.rules.other.pedanticHrefTitle.exec(r);e&&(r=e[1],n=e[3])}else n=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(r=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?r.slice(1):r.slice(1,-1)),e9(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:n&&n.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let e=t[(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){let e=r[0].charAt(0);return{type:"text",raw:e,text:e}}return e9(r,e,r[0],this.lexer,this.rules)}}emStrong(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=this.rules.inline.emStrongLDelim.exec(e);if(!(!n||n[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!r||this.rules.inline.punctuation.exec(r))){let r=[...n[0]].length-1,i,s,a=r,o=0,l="*"===n[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+r);null!=(n=l.exec(t));){if(!(i=n[1]||n[2]||n[3]||n[4]||n[5]||n[6]))continue;if(s=[...i].length,n[3]||n[4]){a+=s;continue}if((n[5]||n[6])&&r%3&&!((r+s)%3)){o+=s;continue}if((a-=s)>0)continue;s=Math.min(s,s+a+o);let t=[...n[0]][0].length,l=e.slice(0,r+n.index+t+s);if(Math.min(r,s)%2){let e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}let c=l.slice(2,-2);return{type:"strong",raw:l,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(e),n=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return r&&n&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let e,r;return r="@"===t[2]?"mailto:"+(e=t[1]):e=t[1],{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e){var t,r;let n;if(n=this.rules.inline.url.exec(e)){let e,i;if("@"===n[2])i="mailto:"+(e=n[0]);else{let s;do s=n[0],n[0]=null!=(r=null==(t=this.rules.inline._backpedal.exec(n[0]))?void 0:t[0])?r:"";while(s!==n[0]);e=n[0],i="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:e,href:i,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}constructor(e){b(this,"options"),b(this,"rules"),b(this,"lexer"),this.options=e||en}},tr=class e{static get rules(){return{block:eY,inline:eX}}static lex(t,r){return new e(r).lex(t)}static lexInline(t,r){return new e(r).inlineTokens(t)}lex(e){e=e.replace(ea.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e){var t,r,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(this.options.pedantic&&(e=e.replace(ea.tabCharGlobal,"    ").replace(ea.spaceLine,""));e;){let a;if(null!=(r=null==(t=this.options.extensions)?void 0:t.block)&&r.some(t=>!!(a=t.call({lexer:this},e,i))&&(e=e.substring(a.raw.length),i.push(a),!0)))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);let t=i.at(-1);1===a.raw.length&&void 0!==t?t.raw+="\n":i.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);let t=i.at(-1);(null==t?void 0:t.type)==="paragraph"||(null==t?void 0:t.type)==="text"?(t.raw+="\n"+a.raw,t.text+="\n"+a.text,this.inlineQueue.at(-1).src=t.text):i.push(a);continue}if((a=this.tokenizer.fences(e))||(a=this.tokenizer.heading(e))||(a=this.tokenizer.hr(e))||(a=this.tokenizer.blockquote(e))||(a=this.tokenizer.list(e))||(a=this.tokenizer.html(e))){e=e.substring(a.raw.length),i.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);let t=i.at(-1);(null==t?void 0:t.type)==="paragraph"||(null==t?void 0:t.type)==="text"?(t.raw+="\n"+a.raw,t.text+="\n"+a.raw,this.inlineQueue.at(-1).src=t.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if((a=this.tokenizer.table(e))||(a=this.tokenizer.lheading(e))){e=e.substring(a.raw.length),i.push(a);continue}let o=e;if(null!=(n=this.options.extensions)&&n.startBlock){let t,r=1/0,n=e.slice(1);this.options.extensions.startBlock.forEach(e=>{"number"==typeof(t=e.call({lexer:this},n))&&t>=0&&(r=Math.min(r,t))}),r<1/0&&r>=0&&(o=e.substring(0,r+1))}if(this.state.top&&(a=this.tokenizer.paragraph(o))){let t=i.at(-1);s&&(null==t?void 0:t.type)==="paragraph"?(t.raw+="\n"+a.raw,t.text+="\n"+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=t.text):i.push(a),s=o.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);let t=i.at(-1);(null==t?void 0:t.type)==="text"?(t.raw+="\n"+a.raw,t.text+="\n"+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=t.text):i.push(a);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw Error(t)}}return this.state.top=!0,i}inline(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e){var t,r,n;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=e,a=null;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(s));)e.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.anyPunctuation.exec(s));)s=s.slice(0,a.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(s));)s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,l="";for(;e;){let a;if(o||(l=""),o=!1,null!=(r=null==(t=this.options.extensions)?void 0:t.inline)&&r.some(t=>!!(a=t.call({lexer:this},e,i))&&(e=e.substring(a.raw.length),i.push(a),!0)))continue;if((a=this.tokenizer.escape(e))||(a=this.tokenizer.tag(e))||(a=this.tokenizer.link(e))){e=e.substring(a.raw.length),i.push(a);continue}if(a=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(a.raw.length);let t=i.at(-1);"text"===a.type&&(null==t?void 0:t.type)==="text"?(t.raw+=a.raw,t.text+=a.text):i.push(a);continue}if((a=this.tokenizer.emStrong(e,s,l))||(a=this.tokenizer.codespan(e))||(a=this.tokenizer.br(e))||(a=this.tokenizer.del(e))||(a=this.tokenizer.autolink(e))||!this.state.inLink&&(a=this.tokenizer.url(e))){e=e.substring(a.raw.length),i.push(a);continue}let c=e;if(null!=(n=this.options.extensions)&&n.startInline){let t,r=1/0,n=e.slice(1);this.options.extensions.startInline.forEach(e=>{"number"==typeof(t=e.call({lexer:this},n))&&t>=0&&(r=Math.min(r,t))}),r<1/0&&r>=0&&(c=e.substring(0,r+1))}if(a=this.tokenizer.inlineText(c)){e=e.substring(a.raw.length),"_"!==a.raw.slice(-1)&&(l=a.raw.slice(-1)),o=!0;let t=i.at(-1);(null==t?void 0:t.type)==="text"?(t.raw+=a.raw,t.text+=a.text):i.push(a);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw Error(t)}}return i}constructor(e){b(this,"tokens"),b(this,"options"),b(this,"state"),b(this,"tokenizer"),b(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||en,this.options.tokenizer=this.options.tokenizer||new tt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:ea,block:eY.normal,inline:eX.normal};this.options.pedantic?(t.block=eY.pedantic,t.inline=eX.pedantic):this.options.gfm&&(t.block=eY.gfm,this.options.breaks?t.inline=eX.breaks:t.inline=eX.gfm),this.tokenizer.rules=t}},tn=class{space(e){return""}code(e){var t;let{text:r,lang:n,escaped:i}=e,s=null==(t=(n||"").match(ea.notSpaceStart))?void 0:t[0],a=r.replace(ea.endingNewline,"")+"\n";return s?'<pre><code class="language-'+e2(s)+'">'+(i?a:e2(a,!0))+"</code></pre>\n":"<pre><code>"+(i?a:e2(a,!0))+"</code></pre>\n"}blockquote(e){let{tokens:t}=e;return"<blockquote>\n".concat(this.parser.parse(t),"</blockquote>\n")}html(e){let{text:t}=e;return t}heading(e){let{tokens:t,depth:r}=e;return"<h".concat(r,">").concat(this.parser.parseInline(t),"</h").concat(r,">\n")}hr(e){return"<hr>\n"}list(e){let t=e.ordered,r=e.start,n="";for(let t=0;t<e.items.length;t++){let r=e.items[t];n+=this.listitem(r)}let i=t?"ol":"ul";return"<"+i+(t&&1!==r?' start="'+r+'"':"")+">\n"+n+"</"+i+">\n"}listitem(e){var t;let r="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?(null==(t=e.tokens[0])?void 0:t.type)==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+e2(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):r+=n+" "}return r+=this.parser.parse(e.tokens,!!e.loose),"<li>".concat(r,"</li>\n")}checkbox(e){let{checked:t}=e;return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){let{tokens:t}=e;return"<p>".concat(this.parser.parseInline(t),"</p>\n")}table(e){let t="",r="";for(let t=0;t<e.header.length;t++)r+=this.tablecell(e.header[t]);t+=this.tablerow({text:r});let n="";for(let t=0;t<e.rows.length;t++){let i=e.rows[t];r="";for(let e=0;e<i.length;e++)r+=this.tablecell(i[e]);n+=this.tablerow({text:r})}return n&&(n="<tbody>".concat(n,"</tbody>")),"<table>\n<thead>\n"+t+"</thead>\n"+n+"</table>\n"}tablerow(e){let{text:t}=e;return"<tr>\n".concat(t,"</tr>\n")}tablecell(e){let t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?"<".concat(r,' align="').concat(e.align,'">'):"<".concat(r,">"))+t+"</".concat(r,">\n")}strong(e){let{tokens:t}=e;return"<strong>".concat(this.parser.parseInline(t),"</strong>")}em(e){let{tokens:t}=e;return"<em>".concat(this.parser.parseInline(t),"</em>")}codespan(e){let{text:t}=e;return"<code>".concat(e2(t,!0),"</code>")}br(e){return"<br>"}del(e){let{tokens:t}=e;return"<del>".concat(this.parser.parseInline(t),"</del>")}link(e){let{href:t,title:r,tokens:n}=e,i=this.parser.parseInline(n),s=e3(t);if(null===s)return i;let a='<a href="'+(t=s)+'"';return r&&(a+=' title="'+e2(r)+'"'),a+=">"+i+"</a>"}image(e){let{href:t,title:r,text:n,tokens:i}=e;i&&(n=this.parser.parseInline(i,this.parser.textRenderer));let s=e3(t);if(null===s)return e2(n);t=s;let a='<img src="'.concat(t,'" alt="').concat(n,'"');return r&&(a+=' title="'.concat(e2(r),'"')),a+=">"}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:e2(e.text)}constructor(e){b(this,"options"),b(this,"parser"),this.options=e||en}},ti=class{strong(e){let{text:t}=e;return t}em(e){let{text:t}=e;return t}codespan(e){let{text:t}=e;return t}del(e){let{text:t}=e;return t}html(e){let{text:t}=e;return t}text(e){let{text:t}=e;return t}link(e){let{text:t}=e;return""+t}image(e){let{text:t}=e;return""+t}br(){return""}},ts=class e{static parse(t,r){return new e(r).parse(t)}static parseInline(t,r){return new e(r).parseInline(t)}parse(e){var t,r;let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i="";for(let s=0;s<e.length;s++){let a=e[s];if(null!=(r=null==(t=this.options.extensions)?void 0:t.renderers)&&r[a.type]){let e=this.options.extensions.renderers[a.type].call({parser:this},a);if(!1!==e||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){i+=e||"";continue}}switch(a.type){case"space":i+=this.renderer.space(a);continue;case"hr":i+=this.renderer.hr(a);continue;case"heading":i+=this.renderer.heading(a);continue;case"code":i+=this.renderer.code(a);continue;case"table":i+=this.renderer.table(a);continue;case"blockquote":i+=this.renderer.blockquote(a);continue;case"list":i+=this.renderer.list(a);continue;case"html":i+=this.renderer.html(a);continue;case"paragraph":i+=this.renderer.paragraph(a);continue;case"text":{let t=a,r=this.renderer.text(t);for(;s+1<e.length&&"text"===e[s+1].type;)t=e[++s],r+="\n"+this.renderer.text(t);n?i+=this.renderer.paragraph({type:"paragraph",raw:r,text:r,tokens:[{type:"text",raw:r,text:r,escaped:!0}]}):i+=r;continue}default:{let e='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw Error(e)}}}return i}parseInline(e){var t,r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.renderer,i="";for(let s=0;s<e.length;s++){let a=e[s];if(null!=(r=null==(t=this.options.extensions)?void 0:t.renderers)&&r[a.type]){let e=this.options.extensions.renderers[a.type].call({parser:this},a);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){i+=e||"";continue}}switch(a.type){case"escape":case"text":i+=n.text(a);break;case"html":i+=n.html(a);break;case"link":i+=n.link(a);break;case"image":i+=n.image(a);break;case"strong":i+=n.strong(a);break;case"em":i+=n.em(a);break;case"codespan":i+=n.codespan(a);break;case"br":i+=n.br(a);break;case"del":i+=n.del(a);break;default:{let e='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw Error(e)}}}return i}constructor(e){b(this,"options"),b(this,"renderer"),b(this,"textRenderer"),this.options=e||en,this.options.renderer=this.options.renderer||new tn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ti}},ta=(te=class{preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?tr.lex:tr.lexInline}provideParser(){return this.block?ts.parse:ts.parseInline}constructor(e){b(this,"options"),b(this,"block"),this.options=e||en}},b(te,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),te),to=new class{walkTokens(e,t){var r,n;let i=[];for(let s of e)switch(i=i.concat(t.call(this,s)),s.type){case"table":for(let e of s.header)i=i.concat(this.walkTokens(e.tokens,t));for(let e of s.rows)for(let r of e)i=i.concat(this.walkTokens(r.tokens,t));break;case"list":i=i.concat(this.walkTokens(s.items,t));break;default:{let e=s;null!=(n=null==(r=this.defaults.extensions)?void 0:r.childTokens)&&n[e.type]?this.defaults.extensions.childTokens[e.type].forEach(r=>{let n=e[r].flat(1/0);i=i.concat(this.walkTokens(n,t))}):e.tokens&&(i=i.concat(this.walkTokens(e.tokens,t)))}}return i}use(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(e=>{let t={...e};if(t.async=this.defaults.async||t.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw Error("extension name required");if("renderer"in e){let t=n.renderers[e.name];t?n.renderers[e.name]=function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];let s=e.renderer.apply(this,n);return!1===s&&(s=t.apply(this,n)),s}:n.renderers[e.name]=e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw Error("extension level must be 'block' or 'inline'");let t=n[e.level];t?t.unshift(e.tokenizer):n[e.level]=[e.tokenizer],e.start&&("block"===e.level?n.startBlock?n.startBlock.push(e.start):n.startBlock=[e.start]:"inline"===e.level&&(n.startInline?n.startInline.push(e.start):n.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(n.childTokens[e.name]=e.childTokens)}),t.extensions=n),e.renderer){let r=this.defaults.renderer||new tn(this.defaults);for(let t in e.renderer){if(!(t in r))throw Error("renderer '".concat(t,"' does not exist"));if(["options","parser"].includes(t))continue;let n=e.renderer[t],i=r[t];r[t]=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let a=n.apply(r,t);return!1===a&&(a=i.apply(r,t)),a||""}}t.renderer=r}if(e.tokenizer){let r=this.defaults.tokenizer||new tt(this.defaults);for(let t in e.tokenizer){if(!(t in r))throw Error("tokenizer '".concat(t,"' does not exist"));if(["options","rules","lexer"].includes(t))continue;let n=e.tokenizer[t],i=r[t];r[t]=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let a=n.apply(r,t);return!1===a&&(a=i.apply(r,t)),a}}t.tokenizer=r}if(e.hooks){let r=this.defaults.hooks||new ta;for(let t in e.hooks){if(!(t in r))throw Error("hook '".concat(t,"' does not exist"));if(["options","block"].includes(t))continue;let n=e.hooks[t],i=r[t];ta.passThroughHooks.has(t)?r[t]=e=>{if(this.defaults.async)return Promise.resolve(n.call(r,e)).then(e=>i.call(r,e));let t=n.call(r,e);return i.call(r,t)}:r[t]=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let a=n.apply(r,t);return!1===a&&(a=i.apply(r,t)),a}}t.hooks=r}if(e.walkTokens){let r=this.defaults.walkTokens,n=e.walkTokens;t.walkTokens=function(e){let t=[];return t.push(n.call(this,e)),r&&(t=t.concat(r.call(this,e))),t}}this.defaults={...this.defaults,...t}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return tr.lex(e,null!=t?t:this.defaults)}parser(e,t){return ts.parse(e,null!=t?t:this.defaults)}parseMarkdown(e){return(t,r)=>{let n={...r},i={...this.defaults,...n},s=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===n.async)return s(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||null===t)return s(Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return s(Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);let a=i.hooks?i.hooks.provideLexer():e?tr.lex:tr.lexInline,o=i.hooks?i.hooks.provideParser():e?ts.parse:ts.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then(e=>a(e,i)).then(e=>i.hooks?i.hooks.processAllTokens(e):e).then(e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then(()=>e):e).then(e=>o(e,i)).then(e=>i.hooks?i.hooks.postprocess(e):e).catch(s);try{i.hooks&&(t=i.hooks.preprocess(t));let e=a(t,i);i.hooks&&(e=i.hooks.processAllTokens(e)),i.walkTokens&&this.walkTokens(e,i.walkTokens);let r=o(e,i);return i.hooks&&(r=i.hooks.postprocess(r)),r}catch(e){return s(e)}}}onError(e,t){return r=>{if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",e){let e="<p>An error occurred:</p><pre>"+e2(r.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(r);throw r}}constructor(...e){b(this,"defaults",er()),b(this,"options",this.setOptions),b(this,"parse",this.parseMarkdown(!0)),b(this,"parseInline",this.parseMarkdown(!1)),b(this,"Parser",ts),b(this,"Renderer",tn),b(this,"TextRenderer",ti),b(this,"Lexer",tr),b(this,"Tokenizer",tt),b(this,"Hooks",ta),this.use(...e)}};function tl(e,t){return to.parse(e,t)}tl.options=tl.setOptions=function(e){return to.setOptions(e),tl.defaults=to.defaults,en=tl.defaults,tl},tl.getDefaults=er,tl.defaults=en,tl.use=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return to.use(...t),tl.defaults=to.defaults,en=tl.defaults,tl},tl.walkTokens=function(e,t){return to.walkTokens(e,t)},tl.parseInline=to.parseInline,tl.Parser=ts,tl.parser=ts.parse,tl.Renderer=tn,tl.TextRenderer=ti,tl.Lexer=tr,tl.lexer=tr.lex,tl.Tokenizer=tt,tl.Hooks=ta,tl.parse=tl,tl.options,tl.setOptions,tl.use,tl.walkTokens,tl.parseInline,ts.parse,tr.lex;class tc{escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}generateSmartLabel(e){if(/^\d/.test(e))throw Error("Invalid field name '".concat(e,"': Field names cannot start with a number"));return e.includes("_")?e.split("_").map(e=>this.capitalizeWord(e)).join(" "):/[a-z][A-Z]/.test(e)?e.replace(/([a-z])([A-Z])/g,"$1 $2").split(" ").map(e=>this.capitalizeWord(e)).join(" "):this.capitalizeWord(e)}capitalizeWord(e){return e&&e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}determineFormId(e,t){var r;return null!=(r=e.attributes)&&r.form?e.attributes.form:t||(t?void 0:this.generateDefaultFormId())}generateDefaultFormId(){return 0===this.formCounter?"formdown-form-default":"formdown-form-".concat(this.formCounter++)}ensureDefaultForm(e,t){return 0===t.length?e:0===e.length?[{id:this.generateDefaultFormId(),attributes:{}}]:e}createFormContext(e,t){let r=new Map;if(0===t.length)return r;let n=[...t].sort((e,t)=>(e.position||0)-(t.position||0)),i=n[0].id;return e.forEach(e=>{var s;if(null!=(s=e.attributes)&&s.form){let n=e.attributes.form;t.some(e=>e.id===n)?r.set(e,n):(console.warn("Form '".concat(n,"' referenced by field '").concat(e.name,"' does not exist. Using default form.")),r.set(e,i))}else{let t=this.findNearestForm(e,n);r.set(e,(null==t?void 0:t.id)||i)}}),r}findNearestForm(e,t){let r;if(!e.position)return t[0];for(let n of t)if(!n.position||n.position<=e.position)r=n;else break;return r||t[0]}generateHTML(e){this.usedIds.clear(),this.fieldCounter=0;let t=e.markdown?tl(e.markdown):"";return"string"==typeof t?this.processContentWithHiddenForms(t,e.forms,e.formDeclarations||[],e.datalistDeclarations||[]):this.generateLegacyHTML(e)}processContentWithHiddenForms(e,t,r,n){if(0===t.length&&0===r.length&&0===n.length)return e;let i=this.ensureDefaultForm(r,t),s=this.generateHiddenFormsHTML(i),a=this.generateDatalistHTML(n),o=this.createFormContext(t,i),l=[],c=[];t.forEach(e=>{e.inline?l.push(e):c.push(e)});let h=e;return l.forEach((e,r)=>{let n="\x3c!--FORMDOWN_FIELD_".concat(t.indexOf(e),"--\x3e"),i=o.get(e),s=this.generateInlineFieldHTML(e,i);h=h.replace(RegExp(n,"g"),s)}),c.forEach(e=>{let r="\x3c!--FORMDOWN_FIELD_".concat(t.indexOf(e),"--\x3e"),n=o.get(e),i=this.generateStandaloneFieldHTML(e,n);h=h.replace(RegExp(r,"g"),i)}),s+a+h}processContent(e,t){if(0===t.length)return e;let r=[],n=[];t.forEach(e=>{e.inline?r.push(e):n.push(e)});let i=e;return r.forEach((e,r)=>{let n="\x3c!--FORMDOWN_FIELD_".concat(t.indexOf(e),"--\x3e"),s=this.generateInlineFieldHTML(e);i=i.replace(RegExp(n,"g"),s)}),n.forEach(e=>{let r="\x3c!--FORMDOWN_FIELD_".concat(t.indexOf(e),"--\x3e"),n=this.generateSingleFieldFormHTML(e);i=i.replace(RegExp(r,"g"),n)}),i}processFieldPlaceholders(e,t){let r=e;return t.forEach((e,t)=>{let n=this.generateStandaloneFieldHTML(e);r=r.replace(RegExp("\x3c!--FORMDOWN_FIELD_".concat(t,"--\x3e"),"g"),n)}),r}generateLegacyHTML(e){return(e.markdown?tl(e.markdown):"")+this.generateFormHTML(e.forms)}generateStandaloneFieldHTML(e,t){if(e.inline)return this.generateInlineFieldHTML(e,t);let r=this.generateFieldHTML(e,t);if(r.includes('<div class="formdown-field">')||["submit","reset","button"].includes(e.type))return'\n<div class="formdown-field-container">\n'.concat(r,"\n</div>");let n=this.generateUniqueId(e.name,t),i=e.label||this.generateSmartLabel(e.name),s=this.determineFormId(e,t),a=e.required?" *":"";return'\n<div class="formdown-field-container">\n<div class="formdown-field">\n    <label for="'.concat(n,'">').concat(i).concat(a,"</label>\n    ").concat(r.replace(/id="[^"]*"/,'id="'.concat(n,'"')).replace(/form="[^"]*"/,s?'form="'.concat(s,'"'):""),"\n</div>\n</div>")}generateSingleFormHTML(e){if(console.warn("generateSingleFormHTML() is deprecated. Use Hidden Form Architecture instead."),0===e.length)return"";let t="form_multi_".concat(Math.random().toString(36).substr(2,9)),r=e.map(e=>this.generateFieldHTML(e,t)).join("\n");return'\n<form class="formdown-form" role="form" id="'.concat(t,'">\n').concat(r,"\n</form>")}generateSingleFieldFormHTML(e){console.warn("generateSingleFieldFormHTML() is deprecated and violates Hidden Form Architecture. Use generateStandaloneFieldHTML() instead.");let t="form_".concat(e.name,"_").concat(Math.random().toString(36).substr(2,9)),r=this.generateFieldHTML(e,t);return'\n<form class="formdown-form" role="form" id="'.concat(t,'">\n').concat(r,"\n</form>")}generateInlineFieldHTML(e,t){let{name:r,type:n,required:i,placeholder:s,attributes:a}=e,o=e.label||this.generateSmartLabel(r),l=this.determineFormId(e,t),c={"data-field-name":r,"data-field-type":n,"data-placeholder":s||o,class:"formdown-inline-field",contenteditable:"true",role:"textbox",...i&&{"data-required":"true"},...l&&{"data-form":l},...a&&a};return"<span ".concat(Object.entries(c).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" "),">").concat(o,"</span>")}generateFormHTML(e){if(console.warn("generateFormHTML() is deprecated. Use Hidden Form Architecture instead."),0===e.length)return"";let t="formdown-legacy-".concat(Math.random().toString(36).substr(2,9)),r=e.map(e=>this.generateFieldHTML(e,t)).join("\n");return'\n<form class="formdown-form" id="'.concat(t,'">\n').concat(r,"\n</form>")}generateFieldHTML(e,t){let{name:r,type:n,label:i,required:s,placeholder:a,attributes:o,options:l,description:c,errorMessage:h,pattern:d,format:u,allowOther:p,content:m,value:f}=e,g=Y.getFieldTypeRegistry().generateFieldHTML(e,{field:e,metadata:{formId:t}});if(g)return g;let b=i||this.generateSmartLabel(r),v="checkbox"===n?m||i||this.generateSmartLabel(r):b,y=this.generateUniqueId(r,t),w=c?"".concat(y,"-description"):void 0,k=h?"".concat(y,"-error"):void 0,x=this.determineFormId(e,t),E={name:"name",first_name:"given-name",last_name:"family-name",email:"email",phone:"tel",phone_number:"tel",password:"current-password",new_password:"new-password",confirm_password:"new-password",username:"username",company:"organization",address:"street-address",city:"address-level2",state:"address-level1",zip:"postal-code",country:"country",birth_date:"bday",birthday:"bday"}[r.toLowerCase()]||("email"===n?"email":"tel"===n?"tel":"password"===n?"current-password":void 0),_={id:y,name:r,...s&&{required:!0},...a&&{placeholder:a},...d&&{pattern:d},...u&&{format:u},...null!=f&&!["textarea","select","radio","checkbox","range","file"].includes(n)&&{value:f},...c&&{"aria-describedby":w},...h&&{"aria-describedby":"".concat(w?w+" ":"").concat(k)},...x&&{form:x},...E&&!(null!=o&&o.autocomplete)&&{autocomplete:E},...o},A=Object.entries(_).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" "),S=()=>{let e="";return c&&(e+='\n    <div id="'.concat(w,'" class="formdown-field-description">').concat(c,"</div>")),h&&(e+='\n    <div id="'.concat(k,'" class="formdown-field-error" role="alert">').concat(h,"</div>")),e};switch(n){case"textarea":let $=f?this.escapeHtml(String(f)):"";return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"","</label>\n    <textarea ").concat(A,">").concat($,"</textarea>").concat(S(),"\n</div>");case"select":let C=(null==l?void 0:l.map(e=>{let t=f&&String(f)===e?" selected":"";return'<option value="'.concat(e,'"').concat(t,">").concat(e,"</option>")}).join("\n"))||"",T=p?'\n        <option value="">'.concat(this.escapeHtml(e.otherLabel||"Other")," (please specify)</option>"):"",R=p?'\n    <input type="text" id="'.concat(y,'_other" placeholder="Please specify..." style="display: none; margin-top: 8px; padding: 6px 10px; border: 1px solid #ccc; border-radius: 4px; background: #fff; width: 100%; max-width: 300px;" class="formdown-other-input">'):"";return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"","</label>\n    <select ").concat(A," ").concat(p?"onchange=\"var container = this.closest('.formdown-field'); var otherInput = container ? container.querySelector('#".concat(y,"_other') : null; if(otherInput) { if(this.value === '') { otherInput.style.display = 'block'; otherInput.focus(); } else { otherInput.style.display = 'none'; } }\""):"",">\n        ").concat(C).concat(T,"\n    </select>").concat(R).concat(p?"\n    <script>\n        document.getElementById('".concat(y,"_other').addEventListener('input', function() {\n            var select = document.getElementById('").concat(y,"');\n            if (select && select.value === '') {\n                select.value = this.value;\n            }\n        });\n    <\/script>"):"").concat(S(),"\n</div>");case"radio":if(!l||0===l.length)return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="text" ').concat(A,">").concat(S(),"\n</div>");let F=l.map((e,n)=>{let i=this.generateUniqueId("".concat(r,"_").concat(n),t),a=s&&0===n,o=f&&String(f)===e;return'\n        <label for="'.concat(i,'" class="formdown-option-label">\n            <input type="radio" id="').concat(i,'" name="').concat(r,'" value="').concat(e,'"').concat(a?" required":"").concat(o?" checked":"").concat(w?' aria-describedby="'.concat(w,'"'):"").concat(p?" onchange=\"var container = this.closest('.formdown-field'); var otherInput = container ? container.querySelector('.formdown-other-input') : null; if(otherInput) { otherInput.style.display = 'none'; }\"":"",">\n            <span>").concat(e,"</span>\n        </label>")}).join("\n"),P=this.generateUniqueId("".concat(r,"_other_radio"),t),M=p?'\n        <label for="'.concat(P,'" class="formdown-option-label">\n            <input type="radio" id="').concat(P,'" name="').concat(r,'" value="" ').concat(w?'aria-describedby="'.concat(w,'"'):""," onchange=\"var container = this.closest('.formdown-field'); var otherInput = container ? container.querySelector('.formdown-other-input') : null; if(otherInput) { otherInput.style.display = 'inline-block'; otherInput.focus(); this.value = otherInput.value || ''; }\"\n            <span>").concat(this.escapeHtml(e.otherLabel||"Other"),':</span>\n            <input type="text" placeholder="Please specify..." style="display: none; margin-left: 8px; padding: 4px 8px; border: 1px solid #ccc; border-radius: 4px; background: #fff;" class="formdown-other-input" onclick="var container = this.closest(\'.formdown-field\'); var otherRadio = container ? container.querySelector(\'#').concat(P,"') : null; if(otherRadio) { otherRadio.checked = true; otherRadio.value = this.value; }\" oninput=\"var container = this.closest('.formdown-field'); var otherRadio = container ? container.querySelector('#").concat(P,"') : null; if(otherRadio) { otherRadio.checked = true; otherRadio.value = this.value; otherRadio.dispatchEvent(new Event('change', {bubbles: true})); }\"\n        </label>"):"",I=(null==o?void 0:o.layout)==="vertical"?"radio-group vertical":"radio-group inline";return'\n<div class="formdown-field">\n    <fieldset '.concat(w?'aria-describedby="'.concat(w,'"'):"",">\n        <legend>").concat(b).concat(s?" *":"",'</legend>\n        <div class="').concat(I,'" role="radiogroup">\n').concat(F).concat(M,"\n        </div>\n    </fieldset>").concat(S(),"\n</div>");case"checkbox":if(l&&0!==l.length){let n=f?String(f).split(",").map(e=>e.trim()):[],i=l.map((e,i)=>{let a=this.generateUniqueId("".concat(r,"_").concat(i),t),o=s&&0===i,l=n.includes(e);return'\n        <label for="'.concat(a,'" class="formdown-option-label">\n            <input type="checkbox" id="').concat(a,'" name="').concat(r,'" value="').concat(e,'"').concat(o?" required":"").concat(l?" checked":"").concat(w?' aria-describedby="'.concat(w,'"'):"",">\n            <span>").concat(e,"</span>\n        </label>")}).join("\n"),a=this.generateUniqueId("".concat(r,"_other_checkbox"),t),c=p?'\n        <label for="'.concat(a,'" class="formdown-option-label">\n            <input type="checkbox" id="').concat(a,'" name="').concat(r,'" value="" ').concat(w?'aria-describedby="'.concat(w,'"'):""," onchange=\"var container = this.closest('.formdown-field'); var otherInput = container ? container.querySelector('.formdown-other-input') : null; if(otherInput) { if(this.checked) { otherInput.style.display = 'inline-block'; otherInput.focus(); this.value = otherInput.value || ''; } else { otherInput.style.display = 'none'; this.value = ''; } }\"\n            <span>").concat(this.escapeHtml(e.otherLabel||"Other"),':</span>\n            <input type="text" placeholder="Please specify..." style="display: none; margin-left: 8px; padding: 4px 8px; border: 1px solid #ccc; border-radius: 4px; background: #fff;" class="formdown-other-input" onclick="var container = this.closest(\'.formdown-field\'); var otherCheckbox = container ? container.querySelector(\'#').concat(a,"') : null; if(otherCheckbox) { otherCheckbox.checked = true; otherCheckbox.value = this.value; }\" oninput=\"var container = this.closest('.formdown-field'); var otherCheckbox = container ? container.querySelector('#").concat(a,"') : null; if(otherCheckbox && otherCheckbox.checked) { otherCheckbox.value = this.value; otherCheckbox.dispatchEvent(new Event('change', {bubbles: true})); }\">\n        </label>"):"",h=(null==o?void 0:o.layout)==="vertical"?"checkbox-group vertical":"checkbox-group inline";return'\n<div class="formdown-field">\n    <fieldset '.concat(w?'aria-describedby="'.concat(w,'"'):"",">\n        <legend>").concat(b).concat(s?" *":"",'</legend>\n        <div class="').concat(h,'" role="group">\n').concat(i).concat(c,"\n        </div>\n    </fieldset>").concat(S(),"\n</div>")}{let e=f&&(!0===f||"true"===f||"true"===String(f).toLowerCase()),t={..._};delete t.id,delete t.name,delete t.form;let n=Object.entries(t).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" "),i=x?' form="'.concat(x,'"'):"";return'\n<div class="formdown-field">\n    <label for="'.concat(y,'" class="formdown-checkbox-label">\n        <input type="checkbox" id="').concat(y,'" name="').concat(r,'" value="true"').concat(s?" required":"").concat(e?" checked":"").concat(i," ").concat(n,">\n        <span>").concat(this.escapeHtml(v)).concat(s?" *":"","</span>\n    </label>").concat(S(),"\n</div>")}case"range":let O=(null==o?void 0:o.min)||0,L=(null==o?void 0:o.max)||100;null!=o&&o.step;let D=void 0!==f?f:(null==o?void 0:o.value)||Math.floor((O+L)/2);return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="range" ').concat(A,' value="').concat(D,'">\n    <output for="').concat(y,'" class="formdown-range-output">').concat(D,"</output>").concat(S(),"\n</div>");case"file":return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="file" ').concat(A,">").concat(S(),"\n</div>");case"color":return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="color" ').concat(A,">").concat(S(),"\n</div>");case"week":return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="week" ').concat(A,">").concat(S(),"\n</div>");case"month":return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="month" ').concat(A,">").concat(S(),"\n</div>");case"submit":let z=x?' form="'.concat(x,'"'):"",q=Object.entries(o||{}).filter(e=>{let[t]=e;return!["form"].includes(t)}).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" ");return'<button type="submit" id="'.concat(y,'"').concat(z).concat(q?" ".concat(q):"",">").concat(e.label||"Submit","</button>");case"reset":let B=x?' form="'.concat(x,'"'):"",H=Object.entries(o||{}).filter(e=>{let[t]=e;return!["form"].includes(t)}).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" ");return'<button type="reset" id="'.concat(y,'"').concat(B).concat(H?" ".concat(H):"",">").concat(e.label||"Reset","</button>");case"button":let N=(null==o?void 0:o.type)||"button",U=x?' form="'.concat(x,'"'):"",V=Object.entries(o||{}).filter(e=>{let[t]=e;return!["form","type"].includes(t)}).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" ");return'<button type="'.concat(N,'" id="').concat(y,'"').concat(U).concat(V?" ".concat(V):"",">").concat(e.label||"Button","</button>");case"image":let j=(null==o?void 0:o.src)||"",W=(null==o?void 0:o.alt)||e.label||"Submit",G=x?' form="'.concat(x,'"'):"",Z=Object.entries(o||{}).filter(e=>{let[t]=e;return!["form","src","alt","type"].includes(t)}).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" ");return'<input type="image" id="'.concat(y,'" src="').concat(j,'" alt="').concat(W,'"').concat(G).concat(Z?" ".concat(Z):"",">");default:return'\n<div class="formdown-field">\n    <label for="'.concat(y,'">').concat(b).concat(s?" *":"",'</label>\n    <input type="').concat(n,'" ').concat(A,">").concat(S(),"\n</div>")}}generateHiddenFormsHTML(e){return 0===e.length?"":e.map(e=>this.generateHiddenFormHTML(e)).join("")}generateHiddenFormHTML(e){let t=Object.entries(e.attributes).map(e=>{let[t,r]=e;return"boolean"==typeof r?r?t:"":"".concat(t,'="').concat(r,'"')}).filter(Boolean).join(" ");return'<form hidden id="'.concat(e.id,'" ').concat(t,"></form>\n")}generateDatalistHTML(e){return 0===e.length?"":e.map(e=>this.generateSingleDatalistHTML(e)).join("")}generateSingleDatalistHTML(e){let t=e.options.map(e=>'<option value="'.concat(this.escapeHtml(e),'">').concat(this.escapeHtml(e),"</option>")).join("");return'<datalist id="'.concat(e.id,'">').concat(t,"</datalist>\n")}generateUniqueId(e,t){let r=e;for(this.usedIds.has(r)&&t&&(r="".concat(t.replace(/^formdown-form-/,"").replace(/-/g,"_"),"_").concat(e)),this.usedIds.has(r)&&(r="".concat(e,"_").concat(++this.fieldCounter));this.usedIds.has(r);)r="".concat(e,"_").concat(++this.fieldCounter);return this.usedIds.add(r),r}constructor(){this.formCounter=0,this.fieldCounter=0,this.usedIds=new Set}}class th{extractSchema(e){let t=this.parser.parse(e),r={};return t.fields.forEach((e,t)=>{r[e.name]=this.convertFieldToSchema(e,t)}),r}convertFieldToSchema(e,t){let r={type:e.type,label:e.label,required:e.required,position:t+1,isInline:e.inline};e.placeholder&&(r.placeholder=e.placeholder),void 0!==e.value&&(r.value=e.value),e.options&&(r.options=e.options),e.allowOther&&(r.allowOther=e.allowOther),e.format&&(r.format=e.format),e.pattern&&(r.pattern=e.pattern),e.description&&(r.description=e.description),e.errorMessage&&(r.errorMessage=e.errorMessage);let n=this.extractValidationRules(e.attributes||{}),i=this.extractFieldValidationRules(e);(n||i)&&(r.validation={...n,...i});let s=this.extractHtmlAttributes(e.attributes||{});return s&&Object.keys(s).length>0&&(r.htmlAttributes=s),r.layout=e.inline?"inline":"vertical",r}extractValidationRules(e){let t={},r=!1;return void 0!==e.min&&(t.min=e.min,r=!0),void 0!==e.max&&(t.max=e.max,r=!0),void 0!==e.step&&(t.step=e.step,r=!0),void 0!==e.minlength&&(t.minlength=e.minlength,r=!0),void 0!==e.maxlength&&(t.maxlength=e.maxlength,r=!0),void 0!==e.pattern&&(t.pattern=e.pattern,r=!0),void 0!==e.accept&&(t.accept=e.accept,r=!0),r?t:void 0}extractFieldValidationRules(e){let t={},r=!1;return void 0!==e.pattern&&(t.pattern=e.pattern,r=!0),r?t:void 0}extractHtmlAttributes(e){let t={},r=new Set(["min","max","step","minlength","maxlength","pattern","accept","required","placeholder","options","allow-other","format"]),n=!1;for(let[i,s]of Object.entries(e))r.has(i)||(t[i]=s,n=!0);return n?t:void 0}constructor(){this.parser=new et}}class td{set(e,t){this.isUpdating||this.data[e]===t||(this.data[e]=t,this.notifyFieldChange(e,t),this.notifyChange(),this.validateField(e,t))}get(e){return e in this.data?this.data[e]:this.schema&&this.schema[e]&&void 0!==this.schema[e].value?this.schema[e].value:void 0}getAll(){return{...this.getSchemaDefaults(),...this.data}}updateAll(e){this.updateInternal(e,!0)}reset(){let e=this.getSchemaDefaults();this.data={},this.updateInternal(e,!0)}isDirty(){let e=this.getAll(),t=this.getSchemaDefaults();return JSON.stringify(e)!==JSON.stringify(t)}validateField(e,t){if(!this.schema||!this.schema[e])return[];let r=tv(void 0!==t?t:this.get(e),{...this.schema[e],name:e});return this.notifyValidation(e,r),r}validate(){if(!this.schema)return{isValid:!0,errors:[]};let e=function(e,t){let r=[];return Object.entries(t).forEach(t=>{let[n,i]=t,s=tv(e[n],{...i,name:n});r.push(...s)}),{isValid:0===r.length,errors:r}}(this.getAll(),this.schema),t=new Map;return e.errors.forEach(e=>{t.has(e.field)||t.set(e.field,[]),t.get(e.field).push(e)}),t.forEach((e,t)=>{this.notifyValidation(t,e)}),e}subscribe(e){return this.changeListeners.add(e),()=>this.changeListeners.delete(e)}subscribeToField(e){return this.fieldChangeListeners.add(e),()=>this.fieldChangeListeners.delete(e)}subscribeToValidation(e){return this.validationListeners.add(e),()=>this.validationListeners.delete(e)}updateSchema(e){this.schema=e,this.initializeFromSchema(),this.notifyChange()}getSchemaDefaults(){if(!this.schema)return{};let e={};return Object.entries(this.schema).forEach(t=>{let[r,n]=t;void 0!==n.value&&(e[r]=n.value)}),e}getModifiedFields(){return Object.keys(this.data)}clear(e){if(e in this.data){delete this.data[e];let t=this.get(e);this.notifyFieldChange(e,t),this.notifyChange()}}hasExplicitValue(e){return e in this.data}createSnapshot(){return{...this.data}}restoreSnapshot(e){this.data={...e},this.notifyChange()}updateInternal(e,t){if(!this.isUpdating){this.isUpdating=!0;try{let r=[];Object.entries(e).forEach(e=>{let[t,n]=e;this.data[t]!==n&&(this.data[t]=n,r.push({field:t,value:n}))}),t&&r.length>0&&(r.forEach(e=>{let{field:t,value:r}=e;this.notifyFieldChange(t,r),this.validateField(t,r)}),this.notifyChange())}finally{this.isUpdating=!1}}}initializeFromSchema(){this.schema&&Object.entries(this.schema).forEach(e=>{let[t,r]=e;void 0===r.value||t in this.data||(this.data[t]=r.value)})}notifyChange(){if(this.isUpdating)return;let e=this.getAll();this.changeListeners.forEach(t=>{try{t(e)}catch(e){console.error("Error in FormDataBinding change listener:",e)}})}notifyFieldChange(e,t){if(this.isUpdating)return;let r=this.getAll();this.fieldChangeListeners.forEach(n=>{try{n(e,t,r)}catch(e){console.error("Error in FormDataBinding field change listener:",e)}})}notifyValidation(e,t){this.validationListeners.forEach(r=>{try{r(e,t)}catch(e){console.error("Error in FormDataBinding validation listener:",e)}})}constructor(e=null,t={}){this.schema=e,this.data={},this.changeListeners=new Set,this.fieldChangeListeners=new Set,this.validationListeners=new Set,this.isUpdating=!1,this.initializeFromSchema(),this.updateInternal(t,!1)}}class tu{processCheckboxGroup(e,t){try{let r=t.querySelectorAll('input[type="checkbox"][name="'.concat(e,'"]'));if(0===r.length)return{success:!1,value:null,errors:["No checkboxes found"]};if(1===r.length&&"true"===r[0].value)return{success:!0,value:r[0].checked||!1};{let e=[];return r.forEach(r=>{if(r.checked)if(""===r.value&&r.id.includes("_other_checkbox")){let n=t.querySelector("#".concat(r.id.replace("_checkbox","_input")));n&&n.value.trim()&&e.push(n.value.trim())}else""!==r.value&&e.push(r.value)}),{success:!0,value:e}}}catch(e){return{success:!1,value:null,errors:["Checkbox processing error: ".concat(e)]}}}processRadioGroup(e,t){try{let r=t.querySelectorAll('input[type="radio"][name="'.concat(e,'"]'));if(0===r.length)return{success:!1,value:"",errors:["No radio buttons found"]};let n="";return r.forEach(e=>{if(e.checked)if(""===e.value&&e.id.includes("_other_radio")){let r=t.querySelector("#".concat(e.id.replace("_radio","_input")));r&&r.value.trim()&&(n=r.value.trim())}else n=e.value}),{success:!0,value:n}}catch(e){return{success:!1,value:"",errors:["Radio processing error: ".concat(e)]}}}processOtherOption(e,t){let r=!t.includes(e)&&""!==e.trim();return{hasOtherValue:r,otherValue:r?e:void 0,regularValues:t}}extractFieldValue(e,t){var r;if(e.hasAttribute("contenteditable"))return(null==(r=e.textContent)?void 0:r.trim())||"";switch(t){case"checkbox":return e.checked||!1;case"radio":return e.checked?e.value:"";case"number":case"range":let n=parseFloat(e.value);return isNaN(n)?0:n;case"date":case"time":case"datetime-local":case"month":case"week":default:return e.value||"";case"file":return e.value&&e.value.split("\\").pop()||""}}setFieldValue(e,t,r,n){try{if(e.hasAttribute("contenteditable"))return Array.isArray(t)?t.join(", "):String(t),e.textContent,!0;switch(r){case"checkbox":if(!Array.isArray(t))return!0;if(!t.includes(e.value)&&e.id.includes("_other_checkbox")&&""===e.value&&n){let r=e.name,i=n.querySelectorAll('input[type="checkbox"][name="'.concat(r,'"]:not([id*="_other_checkbox"])')).map(e=>e.value).filter(e=>""!==e);t.filter(e=>!i.includes(e)&&""!==e).length}return!0;case"radio":let i=String(t);if(e.value!==i&&e.id.includes("_other_radio")&&""===e.value&&n){let t=e.name,r=n.querySelectorAll('input[type="radio"][name="'.concat(t,'"]:not([id*="_other_radio"])')).map(e=>e.value).filter(e=>""!==e);i&&r.includes(i)}return!0;case"select":default:return Array.isArray(t)?t.join(", "):String(t),!0;case"number":case"range":let s="number"==typeof t?t:parseFloat(String(t));return!isNaN(s)}}catch(e){return!1}}validateFieldValue(e,t,r){let n=[];switch(null!=r&&r.required&&(null==e||""===e||Array.isArray(e)&&0===e.length)&&n.push("This field is required"),t){case"email":e&&"string"==typeof e&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||n.push("Please enter a valid email address"));break;case"url":if(e&&"string"==typeof e)try{new URL(e)}catch(e){n.push("Please enter a valid URL")}break;case"number":case"range":if(""!==e&&null!=e){let t=Number(e);isNaN(t)?n.push("Please enter a valid number"):((null==r?void 0:r.min)!==void 0&&t<r.min&&n.push("Value must be at least ".concat(r.min)),(null==r?void 0:r.max)!==void 0&&t>r.max&&n.push("Value must be at most ".concat(r.max)))}break;case"tel":e&&"string"==typeof e&&(/^[\d\s\-\+\(\)]+$/.test(e)||n.push("Please enter a valid phone number"))}return null!=r&&r.pattern&&e&&"string"==typeof e&&(new RegExp(r.pattern).test(e)||n.push(r.patternMessage||"Value does not match required format")),"string"==typeof e&&(null!=r&&r.minLength&&e.length<r.minLength&&n.push("Must be at least ".concat(r.minLength," characters")),null!=r&&r.maxLength&&e.length>r.maxLength&&n.push("Must be at most ".concat(r.maxLength," characters"))),{success:0===n.length,value:e,errors:n.length>0?n:void 0}}getFieldType(e){var t;switch(null==(t=e.type)?void 0:t.toLowerCase()){case"email":return"email";case"password":return"password";case"tel":return"tel";case"url":return"url";case"number":return"number";case"date":return"date";case"time":return"time";case"datetime-local":return"datetime-local";case"month":return"month";case"week":return"week";case"radio":return"radio";case"checkbox":return"checkbox";case"file":return"file";case"color":return"color";case"range":return"range";case"search":return"search";case"hidden":return"hidden";case"button":return"button";case"submit":return"submit";case"reset":return"reset";case"textarea":return"textarea";case"select":return"select";default:return"text"}}}class tp{bindFieldToElement(e,t,r){return this.fieldRegistry[e]||(this.fieldRegistry[e]=new Set),this.fieldRegistry[e].add(t),this.setupElementEventHandlers(t,e,r),{fieldName:e,elements:this.fieldRegistry[e],unbind:()=>this.unbindElement(e,t)}}syncFormData(e,t){if(!this.isUpdatingUI){this.isUpdatingUI=!0;try{let r=Object.keys(this.fieldRegistry),n=Object.keys(e);[...new Set([...r,...n])].forEach(r=>{var n;let i=null!=(n=e[r])?n:"",s=this.fieldRegistry[r];s&&s.forEach(e=>{this.setElementValue(e,i,t)})})}finally{this.isUpdatingUI=!1}}}setupEventDelegation(e,t){}setupElementEventHandlers(e,t,r){let n=()=>{let n;if(!this.isUpdatingUI){if("checkbox"===e.type){let e=this.fieldProcessor.processCheckboxGroup(t,r);if(!e.success)return void console.error("Checkbox processing failed:",e.errors);n=e.value}else if("radio"===e.type){let e=this.fieldProcessor.processRadioGroup(t,r);if(!e.success)return void console.error("Radio processing failed:",e.errors);n=e.value}else{let t=this.fieldProcessor.getFieldType(e);n=this.fieldProcessor.extractFieldValue(e,t)}this.emitFieldChange(t,n,e)}};this.eventListeners.set(e,[{event:"input",handler:n},{event:"change",handler:n}])}setupOtherInputHandlers(e,t,r){let n=()=>{if(this.isUpdatingUI)return;let n=r.querySelector("#".concat(t,"_other_radio")),i=r.querySelector("#".concat(t,"_other_checkbox")),s=e.value.trim();if(n&&s)this.emitFieldChange(t,s,e);else if(i&&s){let n=this.fieldProcessor.processCheckboxGroup(t,r);n.success&&this.emitFieldChange(t,n.value,e)}};this.eventListeners.set(e,[{event:"input",handler:n},{event:"change",handler:n}])}setupContentEditableBehaviors(e,t){let{placeholder:r,selectOnFocus:n}=t,i=[{event:"focus",handler:()=>{var t;null==(t=e.textContent)||t.trim()}},{event:"blur",handler:()=>{var t;null!=(t=e.textContent)&&t.trim()}}];this.eventListeners.set(e,i)}setElementValue(e,t,r){let n=this.fieldProcessor.getFieldType(e);this.fieldProcessor.setFieldValue(e,t,n,r)}emitFieldChange(e,t,r){}unbindElement(e,t){this.fieldRegistry[e]&&(this.fieldRegistry[e].delete(t),0===this.fieldRegistry[e].size&&delete this.fieldRegistry[e]),this.eventListeners.get(t)&&this.eventListeners.delete(t)}getRegisteredFields(){return Object.keys(this.fieldRegistry)}getFieldElements(e){return this.fieldRegistry[e]}clearAllBindings(){Object.keys(this.fieldRegistry).forEach(e=>{this.fieldRegistry[e].forEach(t=>{this.unbindElement(e,t)})}),this.fieldRegistry={},this.eventListeners.clear()}validateAllFields(e,t){let r={};return Object.keys(this.fieldRegistry).forEach(n=>{let i=e[n],s=null==t?void 0:t[n];if(s){let e=this.fieldProcessor.getFieldType(s),t=this.fieldProcessor.validateFieldValue(i,e,s);r[n]=t}}),r}constructor(){this.fieldRegistry={},this.eventListeners=new Map,this.isUpdatingUI=!1,this.fieldProcessor=new tu}}class tm{registerCustomValidator(e,t){this.customValidators.set(e,t)}createValidationPipeline(e){return{rules:e,executeOrder:"fail-fast",skipOnError:!0}}async validateAsync(e,t,r){let n=this.getCacheKey(e.fieldName,t);if(this.validationCache.has(n))return this.validationCache.get(n);let i=this.buildValidationRules(e),s=this.createValidationPipeline(i),a=await this.executeValidationPipeline(s,e,t,r);return this.validationCache.set(n,a),a}async executeValidationPipeline(e,t,r,n){let i=[],s=[];switch(e.executeOrder){case"fail-fast":for(let a of e.rules){let o=await this.executeValidationRule(a,t,r,n);if(!o.isValid&&(i.push(...o.errors),e.skipOnError))break;o.warnings&&s.push(...o.warnings)}break;case"sequential":for(let a of e.rules){let e=await this.executeValidationRule(a,t,r,n);e.isValid||i.push(...e.errors),e.warnings&&s.push(...e.warnings)}break;case"parallel":(await Promise.all(e.rules.map(e=>this.executeValidationRule(e,t,r,n)))).forEach(e=>{e.isValid||i.push(...e.errors),e.warnings&&s.push(...e.warnings)})}return{isValid:0===i.length,errors:i,warnings:s.length>0?s:void 0}}async executeValidationRule(e,t,r,n){try{let i=await e.validator(r,t,n);return"boolean"==typeof i?{isValid:i,errors:i?[]:[{field:t.fieldName,code:e.name,message:e.message||"Validation failed for ".concat(t.fieldName),severity:"error"}]}:"string"==typeof i?{isValid:!1,errors:[{field:t.fieldName,code:e.name,message:i,severity:"error"}]}:i}catch(e){return{isValid:!1,errors:[{field:t.fieldName,code:"validation_error",message:"Validation error: ".concat(e),severity:"error"}]}}}buildValidationRules(e){let t=[];if(e.constraints.required&&t.push({name:"required",validator:t=>!(null==t||""===t||Array.isArray(t)&&0===t.length)||e.constraints.requiredMessage||"".concat(e.schema.label||e.fieldName," is required")}),t.push(...this.getTypeSpecificRules(e)),e.constraints.pattern&&t.push({name:"pattern",validator:t=>!t||new RegExp(e.constraints.pattern).test(String(t))||e.constraints.patternMessage||"Value does not match required format"}),(e.constraints.minLength||e.constraints.maxLength)&&t.push({name:"length",validator:t=>{if(!t)return!0;let r=String(t);return e.constraints.minLength&&r.length<e.constraints.minLength?"Must be at least ".concat(e.constraints.minLength," characters"):!e.constraints.maxLength||!(r.length>e.constraints.maxLength)||"Must be at most ".concat(e.constraints.maxLength," characters")}}),e.constraints.customValidator&&this.customValidators.has(e.constraints.customValidator)){let r=this.customValidators.get(e.constraints.customValidator);t.push({name:e.constraints.customValidator,validator:r,async:!0})}return e.constraints.serverValidation&&t.push({name:"server_validation",validator:(e,t,r)=>this.validateOnServer(e,t,r),async:!0}),t}getTypeSpecificRules(e){let t=[];switch(e.fieldType){case"email":t.push({name:"email_format",validator:e=>!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e))||"Please enter a valid email address"});break;case"url":t.push({name:"url_format",validator:e=>{if(!e)return!0;try{return new URL(String(e)),!0}catch(e){return"Please enter a valid URL"}}});break;case"number":case"range":t.push({name:"number_format",validator:(e,t)=>{if(!e&&0!==e)return!0;let r=Number(e);return isNaN(r)?"Please enter a valid number":void 0!==t.constraints.min&&r<t.constraints.min?"Value must be at least ".concat(t.constraints.min):void 0===t.constraints.max||!(r>t.constraints.max)||"Value must be at most ".concat(t.constraints.max)}});break;case"tel":t.push({name:"phone_format",validator:e=>!e||/^[\d\s\-\+\(\)]+$/.test(String(e))||"Please enter a valid phone number"});break;case"date":t.push({name:"date_format",validator:(e,t)=>{if(!e)return!0;let r=new Date(String(e));if(isNaN(r.getTime()))return"Please enter a valid date";if(t.constraints.min){let e=new Date(t.constraints.min);if(r<e)return"Date must be after ".concat(e.toLocaleDateString())}if(t.constraints.max){let e=new Date(t.constraints.max);if(r>e)return"Date must be before ".concat(e.toLocaleDateString())}return!0}})}return t}async validateOnServer(e,t,r){let n=t.constraints.serverValidation;return new Promise(i=>{let s=this.asyncValidationTimers.get(t.fieldName);s&&clearTimeout(s);let a=setTimeout(async()=>{try{let s=await this.makeValidationRequest(e,t,r,n);i(s)}catch(e){i({isValid:!1,errors:[{field:t.fieldName,code:"server_error",message:"Server validation failed",severity:"error"}]})}},n.debounceMs||500);this.asyncValidationTimers.set(t.fieldName,a)})}async makeValidationRequest(e,t,r,n){return t.fieldName,{isValid:!0,errors:[]}}validateCrossFields(e,t){let r=[];return t.forEach(t=>{try{let n=t.validator(e);"string"==typeof n?r.push({field:t.fields[0],code:t.name,message:n,severity:"error"}):"object"!=typeof n||n.isValid||r.push(...n.errors)}catch(e){r.push({field:t.fields[0],code:"cross_field_error",message:"Cross-field validation error: ".concat(e),severity:"error"})}}),{isValid:0===r.length,errors:r}}clearCache(e){if(e)for(let t of this.validationCache.keys())t.startsWith("".concat(e,":"))&&this.validationCache.delete(t);else this.validationCache.clear()}getCacheKey(e,t){return"".concat(e,":").concat(JSON.stringify(t))}dispose(){this.asyncValidationTimers.forEach(e=>clearTimeout(e)),this.asyncValidationTimers.clear(),this.validationCache.clear()}constructor(){this.customValidators=new Map,this.validationCache=new Map,this.asyncValidationTimers=new Map}}let tf={FORM_INITIALIZED:"formdown:form:initialized",FORM_READY:"formdown:form:ready",FORM_DESTROYED:"formdown:form:destroyed",FIELD_CHANGE:"formdown:field:change",FIELD_INVALID:"formdown:field:invalid",FIELD_VALID:"formdown:field:valid",DATA_CHANGE:"formdown:data:change",DATA_SYNC:"formdown:data:sync",VALIDATION_START:"formdown:validation:start",VALIDATION_SUCCESS:"formdown:validation:success",VALIDATION_ERROR:"formdown:validation:error",UI_RENDER_COMPLETE:"formdown:ui:render:complete",UI_UPDATE:"formdown:ui:update",EDITOR_CONTENT_CHANGE:"formdown:editor:content:change",EDITOR_PREVIEW_UPDATE:"formdown:editor:preview:update",EDITOR_ERROR:"formdown:editor:error",EXTENSION_LOADED:"formdown:extension:loaded",SCHEMA_CHANGE:"formdown:schema:change"};class tg{createEventBus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bus_".concat(Date.now()),t=new Map,r={emit:(r,n)=>{let i=t.get(r);i&&i.forEach(e=>{try{e(n)}catch(e){console.error("Error in event handler for ".concat(r,":"),e)}}),this.globalEventConfig.bubbleEvents&&"global"!==e&&this.globalEventBus.emit(r,{source:e,data:n})},on:(e,r)=>(t.has(e)||t.set(e,new Set),t.get(e).add(r),()=>{var n;null==(n=t.get(e))||n.delete(r)}),off:(e,r)=>{var n;null==(n=t.get(e))||n.delete(r)},once:(e,t)=>{let n=i=>{t(i),r.off(e,n)};return r.on(e,n)},clear:()=>{t.clear()}};return this.eventBuses.set(e,r),r}bridgeComponentEvents(e,t,r){let n="".concat(e.id,"_to_").concat(t.id),i={source:e,target:t,eventMappings:r,isActive:!0};return r.forEach(r=>{e.on&&e.on(r.sourceEvent,e=>{if(!i.isActive||r.condition&&!r.condition(e))return;let n=e;if(r.transformer)try{n=r.transformer(e)}catch(e){console.error("Error in event transformer for ".concat(r.sourceEvent,":"),e);return}t.emit&&t.emit(r.targetEvent,n)})}),this.eventBridges.set(n,i),n}setupGlobalEventHandling(){this.globalEventConfig.enableFormEvents&&this.setupFormEventHandlers(),this.globalEventConfig.enableFieldEvents&&this.setupFieldEventHandlers(),this.globalEventConfig.enableValidationEvents&&this.setupValidationEventHandlers(),this.globalEventConfig.enableLifecycleEvents&&this.setupLifecycleEventHandlers()}setupFormEventHandlers(){this.globalEventBus.on(tf.FORM_INITIALIZED,e=>{console.debug("Form initialized:",e)}),this.globalEventBus.on(tf.DATA_CHANGE,e=>{this.globalEventBus.emit(tf.DATA_SYNC,e)}),this.globalEventBus.on(tf.FORM_DESTROYED,e=>{this.cleanupFormEventBridges(null==e?void 0:e.formId)})}setupFieldEventHandlers(){this.globalEventBus.on(tf.FIELD_CHANGE,e=>{this.globalEventBus.emit(tf.VALIDATION_START,{fieldName:e.fieldName,value:e.value})}),this.globalEventBus.on(tf.FIELD_INVALID,e=>{console.debug("Field validation error:",e)})}setupValidationEventHandlers(){this.globalEventBus.on(tf.VALIDATION_ERROR,e=>{console.debug("Validation error:",e)}),this.globalEventBus.on(tf.VALIDATION_SUCCESS,e=>{console.debug("Validation success:",e)})}setupLifecycleEventHandlers(){this.globalEventBus.on(tf.UI_RENDER_COMPLETE,e=>{this.globalEventBus.emit(tf.FORM_READY,e)}),this.globalEventBus.on(tf.EXTENSION_LOADED,e=>{console.debug("Extension loaded:",e)})}createCoreUIBridge(e,t){let r=[{sourceEvent:tf.DATA_CHANGE,targetEvent:tf.UI_UPDATE,transformer:e=>({formData:e.formData})},{sourceEvent:tf.VALIDATION_ERROR,targetEvent:tf.FIELD_INVALID,transformer:e=>({fieldName:e.field,errors:e.errors})},{sourceEvent:tf.VALIDATION_SUCCESS,targetEvent:tf.FIELD_VALID,transformer:e=>({fieldName:e.field})},{sourceEvent:tf.FIELD_CHANGE,targetEvent:tf.DATA_CHANGE,transformer:e=>({fieldName:e.fieldName,value:e.value,formData:e.formData})}];return this.bridgeComponentEvents(e,t,r)}createCoreEditorBridge(e,t){let r=[{sourceEvent:tf.SCHEMA_CHANGE,targetEvent:tf.EDITOR_PREVIEW_UPDATE,transformer:e=>({schema:e.schema})},{sourceEvent:tf.EDITOR_CONTENT_CHANGE,targetEvent:tf.SCHEMA_CHANGE,transformer:e=>({content:e.content})},{sourceEvent:tf.VALIDATION_ERROR,targetEvent:tf.EDITOR_ERROR,transformer:e=>({errors:e.errors})}];return this.bridgeComponentEvents(e,t,r)}getGlobalEventBus(){return this.globalEventBus}getEventBus(e){return this.eventBuses.get(e)}removeBridge(e){let t=this.eventBridges.get(e);t&&(t.isActive=!1,this.eventBridges.delete(e))}cleanupFormEventBridges(e){if(e)for(let[t,r]of this.eventBridges.entries())t.includes(e)&&this.removeBridge(t)}getActiveBridges(){return Array.from(this.eventBridges.values()).filter(e=>e.isActive)}dispose(){this.eventBuses.forEach(e=>e.clear()),this.eventBuses.clear(),this.eventBridges.forEach(e=>{e.isActive=!1}),this.eventBridges.clear(),this.globalEventBus.clear()}configureEvents(e){this.globalEventConfig={...this.globalEventConfig,...e},this.setupGlobalEventHandling()}getEventStats(){return{totalEventBuses:this.eventBuses.size,totalBridges:this.eventBridges.size,activeBridges:this.getActiveBridges().length}}constructor(e={}){this.eventBuses=new Map,this.eventBridges=new Map,this.globalEventConfig={enableFormEvents:!0,enableFieldEvents:!0,enableValidationEvents:!0,enableLifecycleEvents:!0,bubbleEvents:!0,eventPrefix:"formdown",...e},this.globalEventBus=this.createEventBus("global")}}class tb{parse(e){return this.content=e,this.parsedContent=this.parser.parseFormdown(e),this.schema=new th().extractSchema(e),this.dataBinding=new td(this.schema),this.setupDataBindingEvents(),this.parsedContent}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.parsedContent)throw Error("No content parsed. Call parse() first.");return"json"===e.outputFormat?JSON.stringify(this.parsedContent,null,2):this.generator.generateHTML(this.parsedContent)}getSchema(){return this.schema?{...this.schema}:null}getData(){return this.dataBinding?this.dataBinding.getAll():{}}setFieldValue(e,t){this.dataBinding&&this.dataBinding.set(e,t)}updateData(e){this.dataBinding&&this.dataBinding.updateAll(e)}reset(){this.dataBinding&&(this.dataBinding.reset(),this.emit("form-reset",{formData:this.getData()}))}validate(){return this.dataBinding?this.dataBinding.validate():{isValid:!0,errors:[]}}getDefaultValues(){return this.dataBinding?this.dataBinding.getSchemaDefaults():{}}isDirty(){return!!this.dataBinding&&this.dataBinding.isDirty()}getField(e){return this.parsedContent&&this.parsedContent.forms.find(t=>t.name===e)||null}getFields(){var e;return(null==(e=this.parsedContent)?void 0:e.forms)||[]}getFormDeclarations(){var e;return(null==(e=this.parsedContent)?void 0:e.formDeclarations)||[]}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}off(e,t){let r=this.eventListeners.get(e);r&&r.delete(t)}emit(e,t){let r=this.eventListeners.get(e);r&&r.forEach(r=>{try{r(t)}catch(t){console.error("Error in FormManager event handler for '".concat(e,"':"),t)}})}setupDataBindingEvents(){this.dataBinding&&(this.dataBinding.subscribeToField((e,t,r)=>{this.emit("data-change",{field:e,value:t,formData:r})}),this.dataBinding.subscribeToValidation((e,t)=>{t.length>0&&this.emit("validation-error",{field:e,errors:t})}))}clone(){return new tb(this.options)}export(){return{content:this.content,data:this.getData(),schema:this.getSchema(),options:{...this.options}}}import(e){e.options&&(Object.assign(this.options,e.options),this.parser=new et(this.options)),this.parse(e.content),e.data&&this.updateData(e.data)}createFieldProcessor(){return this.fieldProcessor||(this.fieldProcessor=new tu),this.fieldProcessor}createDOMBinder(){return this.domBinder||(this.domBinder=new tp),this.domBinder}createValidationManager(){return this.validationManager||(this.validationManager=new tm),this.validationManager}createEventOrchestrator(){return this.eventOrchestrator||(this.eventOrchestrator=new tg),this.eventOrchestrator}processFieldValue(e,t){let r=this.createFieldProcessor(),n=this.getField(e);if(!n)return console.warn("Field ".concat(e," not found in schema")),t;let i=r.getFieldType({id:e,name:e,value:String(t),type:n.type||"text",hasAttribute:()=>!1,getAttribute:()=>null});return r.extractFieldValue({id:e,name:e,value:String(t),type:n.type||"text",hasAttribute:()=>!1,getAttribute:()=>null},i)}async validateFieldWithPipeline(e,t){let r=this.createValidationManager(),n=this.getField(e),i=this.createFieldProcessor();if(!n)return{isValid:!1,errors:["Field ".concat(e," not found")]};let s=i.getFieldType({id:e,name:e,value:String(t),type:n.type||"text",hasAttribute:()=>!1,getAttribute:()=>null}),a={fieldName:e,fieldType:s,constraints:n.attributes||{},schema:n};return await r.validateAsync(a,t,this.getData())}setupComponentBridge(e){let t=this.createEventOrchestrator(),r={id:"formdown-core",type:"core",emit:(e,t)=>{"formdown:data:change"===e?this.emit("data-change",t):"formdown:validation:error"===e&&this.emit("validation-error",t)},on:(e,t)=>("formdown:field:change"===e&&this.on("data-change",t),()=>{})};return"ui"===e.type?t.createCoreUIBridge(r,e):"editor"===e.type?t.createCoreEditorBridge(r,e):t.bridgeComponentEvents(r,e,[])}renderToTemplate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.parsedContent)throw Error("No content parsed. Call parse() first.");return{fields:this.getFields(),formDeclarations:this.getFormDeclarations(),schema:this.getSchema(),data:this.getData(),html:this.render(),options:e}}handleUIEvent(e,t){t||(t=this.createDOMBinder());let r=e.target,n=(null==r?void 0:r.name)||(null==r?void 0:r.id);if(n&&"change"===e.type){let e=this.createFieldProcessor(),t=e.getFieldType(r),i=e.extractFieldValue(r,t);this.setFieldValue(n,i)}}createPreviewTemplate(e){try{let t=new tb(this.options);return t.parse(e),{html:t.render(),errors:[],schema:t.getSchema(),fields:t.getFields()}}catch(e){return{html:"",errors:[String(e)],schema:null,fields:[]}}}getCoreModules(){return{fieldProcessor:this.fieldProcessor,domBinder:this.domBinder,validationManager:this.validationManager,eventOrchestrator:this.eventOrchestrator}}dispose(){this.validationManager&&(this.validationManager.dispose(),this.validationManager=null),this.domBinder&&(this.domBinder.clearAllBindings(),this.domBinder=null),this.eventOrchestrator&&(this.eventOrchestrator.dispose(),this.eventOrchestrator=null),this.fieldProcessor=null,this.eventListeners.clear(),this.dataBinding&&(this.dataBinding=null)}constructor(e={}){this.options=e,this.content="",this.parsedContent=null,this.schema=null,this.dataBinding=null,this.eventListeners=new Map,this.fieldProcessor=null,this.domBinder=null,this.validationManager=null,this.eventOrchestrator=null,this.parser=new et(e),this.generator=new tc,[].forEach(e=>{this.eventListeners.set(e,new Set)})}}function tv(e,t){let r=[];return t.required&&(!e||""===e.toString().trim())&&r.push({field:t.name||"field",message:t.errorMessage||"".concat(t.label||"Field"," is required")}),r}let ty=class e{static getInstance(){return e.instance||(e.instance=new e),e.instance}async initialize(){if(!this.initialized)try{await Y.initialize(),this.setupEditorHooks(),this.initialized=!0}catch(e){console.debug("Extension system already initialized or error:",e)}}setupEditorHooks(){ee({name:"pre-parse",priority:1,handler:this.handlePreParse.bind(this)}),ee({name:"post-parse",priority:1,handler:this.handlePostParse.bind(this)}),ee({name:"field-validate",priority:1,handler:this.handleFieldValidate.bind(this)})}handlePreParse(e){return e}handlePostParse(e){return e}handleFieldValidate(e,t){return{valid:!0,message:""}}async registerEditorPlugin(e){await X(e)}getExtensionStats(){return Y.getStats()}async executeEditorHooks(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return Y.executeHooks(e,t,...n)}async validateContent(e){try{let t=await this.executeEditorHooks("field-validate",{input:e},e),r=[];return t.forEach(e=>{e&&!e.valid&&e.message&&r.push(e.message)}),{isValid:0===r.length,errors:r}}catch(e){return{isValid:!1,errors:[e instanceof Error?e.message:"Validation error"]}}}constructor(){this.initialized=!1}};ty.instance=null;let tw=ty,tk=tw.getInstance();var tx=Object.defineProperty,tE=Object.getOwnPropertyDescriptor,t_=(e,t,r,n)=>{for(var i,s=n>1?void 0:n?tE(t,r):t,a=e.length-1;a>=0;a--)(i=e[a])&&(s=(n?i(t,r,s):i(s))||s);return n&&s&&tx(t,r,s),s},tA='# Contact Form\n\nFill out the form below to get in touch:\n\n@full_name: [text required placeholder="Enter your full name"]\n@email_address: [email required]\n@phone_number: [tel]\n@message: [textarea rows=4 placeholder="Your message here..."]\n@contact_method: [radio options="Email, Phone, Either"]\n@newsletter_signup: [checkbox]';let tS=class extends i.WF{get data(){if(this.formManager){let e=this.formManager.getData();if(e&&Object.keys(e).length>0)return e}return this._data}set data(e){let t={};null!=e&&"object"==typeof e&&(t="formData"in e&&"object"==typeof e.formData?{...e.formData}:{...e},t=this.processCheckboxFields(t)),this._data=t,this.formManager&&this.formManager.updateData(t),this.requestUpdate("data")}async connectedCallback(){var e;super.connectedCallback(),this.formManager=new tb,this.formManager.setupComponentBridge({id:"formdown-editor",type:"editor",emit:(e,t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},on:(e,t)=>()=>{}}),this.formManager.on("data-change",e=>{let{formData:t}=e,r=this.processCheckboxFields(t);this._data=r,this.requestUpdate("data"),this.dispatchEvent(new CustomEvent("formdown-data-update",{detail:r,bubbles:!0,composed:!0}))}),this._data&&Object.keys(this._data).length>0&&this.formManager.updateData(this._data);try{await tk.initialize()}catch(e){console.debug("Extension system initialization:",e)}this.content===tA&&null!=(e=this.textContent)&&e.trim()&&(this.content=this.textContent.trim(),this.textContent=""),await this.updateParseResult()}willUpdate(e){var t;if(super.willUpdate(e),e.has("content")){let e=null==(t=this.shadowRoot)?void 0:t.querySelector(".editor-textarea");if(e&&document.activeElement===e)return}}render(){return(0,i.qy)(c(),this.mode,"view"!==this.mode?(0,i.qy)(a(),this.header?(0,i.qy)(s()):"",this.renderToolbar(),this.content,this.handleInput,this.handleKeydown,this.placeholder,this.content.split("\n").length,this.content.length):"","edit"!==this.mode?(0,i.qy)(l(),this.header?(0,i.qy)(o()):"",this.renderErrors()):"")}updated(e){var t;if(super.updated(e),e.has("mode")){let e=this._data;"edit"!==this.mode&&(this.updateFormdownUI(),e&&Object.keys(e).length>0&&setTimeout(()=>{var t;let r=null==(t=this.shadowRoot)?void 0:t.querySelector("#formdown-ui-container"),n=null==r?void 0:r.querySelector("formdown-ui");n&&(n.data=e)},0));return}if("edit"!==this.mode&&(e.has("content")||e.has("parseResult"))&&this.updateFormdownUI(),e.has("data")&&"edit"!==this.mode){let e=null==(t=this.shadowRoot)?void 0:t.querySelector("#formdown-ui-container"),r=null==e?void 0:e.querySelector("formdown-ui");r&&(r.data=this.data||{})}}firstUpdated(e){super.firstUpdated(e),"edit"!==this.mode&&this.updateFormdownUI()}updateFormdownUI(){var e;let t=null==(e=this.shadowRoot)?void 0:e.querySelector("#formdown-ui-container");if(t)try{if(!customElements.get("formdown-ui")){t.innerHTML='<div style="padding: 1rem; color: #666;">Loading form preview...</div>';return}let e=t.querySelector("formdown-ui");e||((e=document.createElement("formdown-ui")).style.width="100%",e.style.height="100%",e.addEventListener("formdown-data-update",e=>{var t;let r=(null==(t=e.detail)?void 0:t.formData)||e.detail;this.formManager.updateData(r)}),e.addEventListener("formdown-change",e=>{this.dispatchEvent(new CustomEvent("formdown-change",{detail:e.detail,bubbles:!0,composed:!0}))}),t.appendChild(e)),e.setAttribute("content",this.content),this._data&&Object.keys(this._data).length>0&&(e.data=this._data)}catch(e){t.innerHTML='<div style="padding: 1rem; color: #dc2626;">Preview Error: '.concat(e instanceof Error?e.message:"Unknown error","</div>")}}handleInput(e){let t=e.target;this.content=t.value,this.updateParseResult(),this.dispatchContentChange()}handleKeydown(e){if("Tab"===e.key){e.preventDefault();let t=e.target,r=t.selectionStart,n=t.selectionEnd,i=t.value.substring(0,r),s=t.value.substring(n);t.value=i+"  "+s,t.selectionStart=t.selectionEnd=r+2,this.content=t.value,this.updateParseResult(),this.dispatchContentChange()}}insertSnippet(e){var t;let r=null==(t=this.shadowRoot)?void 0:t.querySelector(".editor-textarea");if(!r)return;let n=r.selectionStart,i=r.selectionEnd,s=this.content.substring(0,n),a=this.content.substring(i);this.content=s+e+a,this.updateParseResult(),this.dispatchContentChange(),this.updateComplete.then(()=>{r.focus(),r.selectionStart=r.selectionEnd=n+e.length})}async updateParseResult(){try{this.formManager.parse(this.content);let e=await tk.validateContent(this.content),t=this.formManager.getFields();this.parseResult={fields:t||[],errors:e.errors.map(e=>({line:0,message:e}))}}catch(e){this.parseResult={fields:[],errors:[{line:0,message:e instanceof Error?e.message:"Parse error"}]}}}dispatchContentChange(){this.dispatchEvent(new CustomEvent("contentChange",{detail:{content:this.content},bubbles:!0,composed:!0}))}renderToolbar(){return this.toolbar?(0,i.qy)(d(),[{name:"Text",snippet:"@name: [text required]"},{name:"Textarea",snippet:"@bio: [textarea rows=4]"},{name:"Radio",snippet:'@gender: [radio required options="Option 1,Option 2"]'},{name:"Check",snippet:'@interests: [checkbox options="Item 1,Item 2"]'},{name:"Select",snippet:'@country: [select required options="USA,Canada,UK"]'},{name:"Range",snippet:'@volume: [range min=0 max=100 unit="%"]'}].map(e=>(0,i.qy)(h(),()=>this.insertSnippet(e.snippet),e.name))):""}renderErrors(){return 0===this.parseResult.errors.length?"":(0,i.qy)(p(),this.parseResult.errors.map(e=>(0,i.qy)(u(),e)))}processCheckboxFields(e){if(!e||"object"!=typeof e)return e;let t={...e};return this.getCheckboxFieldsFromContent().forEach(e=>{let{fieldName:r,isGroup:n}=e;if(r in t){let e=t[r];n?Array.isArray(e)?t[r]=e:"string"==typeof e&&""!==e.trim()?t[r]=e.split(",").map(e=>e.trim()).filter(e=>e):t[r]=e?[e]:[]:"boolean"==typeof e?t[r]=e:Array.isArray(e)?t[r]=e.length>0:t[r]=!!e}}),t}getCheckboxFieldsFromContent(){let e=[];return this.content.split("\n").forEach(t=>{let r=t.match(/@(\w+):\s*\[([^\]]*checkbox[^\]]*)\]/i);if(r){let t=r[1],n=r[2].includes("options=");e.push({fieldName:t,isGroup:n})}}),e}validate(){var e;let t=null==(e=this.shadowRoot)?void 0:e.querySelector(".preview-content"),r=null==t?void 0:t.querySelector("formdown-ui");return r&&"function"==typeof r.validate?r.validate():{isValid:!1,errors:[{field:"general",message:"FormdownUI component not found for validation"}]}}getFormData(){var e;let t=null==(e=this.shadowRoot)?void 0:e.querySelector(".preview-content"),r=null==t?void 0:t.querySelector("formdown-ui");return r&&"function"==typeof r.getFormData?r.getFormData():{}}constructor(){super(...arguments),this.content=tA,this.mode="split",this.placeholder='Try FormDown with smart labels! Field names like "full_name" become "Full Name" automatically...',this.header=!1,this.toolbar=!0,this._data={},this.parseResult={fields:[],errors:[]}}};tS.styles=(0,i.AH)(m(),(0,i.iz)(":host{display:block;font-family:system-ui,-apple-system,sans-serif;height:600px;border:1px solid var(--theme-border, #d1d5db);border-radius:.375rem;overflow:hidden;background:var(--theme-bg-primary, #ffffff)}.editor-container{display:flex;height:100%;background:var(--theme-bg-primary, #ffffff)}.editor-panel{flex:1;display:flex;flex-direction:column;border-right:1px solid var(--theme-border, #d1d5db);background:var(--theme-bg-primary, #ffffff)}.preview-panel{flex:1;display:flex;flex-direction:column;background-color:var(--theme-bg-secondary, #f9fafb)}.panel-header{padding:.75rem 1rem;background-color:var(--theme-bg-secondary, #f3f4f6);border-bottom:1px solid var(--theme-border, #d1d5db);font-weight:500;font-size:.875rem;color:var(--theme-text-primary, #374151)}.editor-textarea{flex:1;width:100%;border:none;outline:none;padding:1rem;font-family:Monaco,Menlo,Ubuntu Mono,monospace;font-size:.875rem;line-height:1.5;resize:none;background-color:var(--theme-bg-primary, white);color:var(--theme-text-primary, #1f2937);height:0}.preview-content{flex:1;padding:1rem;overflow-y:auto;height:0}.toolbar{display:flex;padding:.5rem;background-color:var(--theme-bg-secondary, #f9fafb);border-bottom:1px solid var(--theme-border, #d1d5db);gap:.5rem}.toolbar-button{padding:.25rem .5rem;background-color:var(--theme-bg-primary, white);border:1px solid var(--theme-border, #d1d5db);border-radius:.25rem;font-size:.75rem;cursor:pointer;transition:background-color .15s ease-in-out;color:var(--theme-text-primary, #1f2937)}.toolbar-button:hover{background-color:var(--theme-bg-secondary, #f3f4f6)}.stats{padding:.5rem 1rem;background-color:var(--theme-bg-secondary, #f9fafb);border-top:1px solid var(--theme-border, #d1d5db);font-size:.75rem;color:var(--theme-text-secondary, #6b7280);display:flex;justify-content:space-between}.error-list{background-color:var(--theme-error-bg, #fef2f2);border-left:4px solid var(--theme-error, #dc2626);padding:1rem;margin-bottom:1rem}.error-item{color:var(--theme-error, #dc2626);font-size:.875rem;margin-bottom:.25rem}.mode-edit .preview-panel,.mode-view .editor-panel{display:none}.mode-edit .editor-panel{border-right:none}.mode-view{overflow-y:auto}.mode-view .preview-panel{border-right:none;height:auto;min-height:100%}@media (max-width: 768px){.editor-container{flex-direction:column}.editor-panel{border-right:none;border-bottom:1px solid var(--theme-border, #d1d5db)}}")),t_([U()],tS.prototype,"content",2),t_([U({type:String})],tS.prototype,"mode",2),t_([U({type:String})],tS.prototype,"placeholder",2),t_([U({type:Boolean})],tS.prototype,"header",2),t_([U({type:Boolean})],tS.prototype,"toolbar",2),t_([V()],tS.prototype,"_data",2),t_([V()],tS.prototype,"parseResult",2),tS=t_([(e=>(t,r)=>{void 0!==r?r.addInitializer(()=>{customElements.define(e,t)}):customElements.define(e,t)})("formdown-editor")],tS);let t$=Object.freeze(Object.defineProperty({__proto__:null,get FormdownEditor(){return tS}},Symbol.toStringTag,{value:"Module"})),tC=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=document.createElement("formdown-editor");return t.content&&(r.content=t.content),void 0!==t.showPreview&&(r.showPreview=t.showPreview),void 0!==t.showToolbar&&(r.showToolbar=t.showToolbar),t.placeholder&&(r.placeholder=t.placeholder),e.appendChild(r),r},tT=()=>{customElements.get("formdown-editor")||Promise.resolve().then(()=>t$)}},5933:(e,t,r)=>{r.d(t,{_:()=>n});function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}}}]);